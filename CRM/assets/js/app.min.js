function delayAction(t,e){var a=0;return function(){var i=this,n=arguments;clearTimeout(a),a=setTimeout(function(){t.apply(i,n)},e||0)}}function selectLastlySelectedTab(t){t||(t=""),$(t+" [data-bs-toggle='ajax-tab']").each(function(){var t=$(this),e=t.attr("id"),a=getCookie("user_"+AppHelper.userId+"_"+e),i=t.find("[data-bs-target='"+a+"']");"1"==t.attr("data-do-not-save-state")&&(a=null),a&&i.attr("data-bs-target")?setTimeout(function(){i.trigger("click")},50):t.find("a").first().trigger("click")})}$(document).ready(function(){$.ajaxSetup({cache:!1}),moment.locale(AppLanugage.locale),moment.fn.customFormat=function(t){let e=this.year(),a=String(this.month()+1).padStart(2,"0"),i=String(this.date()).padStart(2,"0");return t.replace("YYYY",e).replace("MM",a).replace("DD",i)},(t=jQuery).fn.datepicker.dates.custom={days:AppLanugage.days,daysShort:AppLanugage.daysShort,daysMin:AppLanugage.daysMin,months:AppLanugage.months,monthsShort:AppLanugage.monthsShort,today:AppLanugage.today},$("body").on("click","[data-act=ajax-modal]",function(t){$(this).closest("td.all").length>0&&$(this).closest("td.all").trigger("click");var e={ajaxModal:1},a=$(this).attr("data-action-url"),i=$(this).attr("data-modal-lg"),n=$(this).attr("data-modal-fullscreen"),s=$(this).attr("data-modal-custom-bg"),r=$(this).attr("data-modal-close"),o=$(this).attr("data-title"),l=$(this).attr("data-modal-class");if(!a)return console.log("Ajax Modal: Set data-action-url!"),!1;o?$("#ajaxModalTitle").html(o):$("#ajaxModalTitle").html($("#ajaxModalTitle").attr("data-title")),$(this).attr("data-post-hide-header")?($("#ajaxModal .modal-header").addClass("hide"),$("#ajaxModal .modal-footer").addClass("hide")):($("#ajaxModal .modal-header").removeClass("hide"),$("#ajaxModal .modal-footer").removeClass("hide")),$("#ajaxModalContent").html($("#ajaxModalOriginalContent").html()),$("#ajaxModalContent").find(".original-modal-body").removeClass("original-modal-body").addClass("modal-body"),$("#ajaxModal").modal("show"),$("#ajaxModal").find(".modal-dialog").removeClass("custom-modal-lg"),$("#ajaxModal").find(".modal-dialog").removeClass("modal-fullscreen"),$("#ajaxModal").find(".modal-dialog").removeClass("custom-bg-modal"),$("#ajaxModal").removeClass("global-search-modal");var d=$("#ajaxModal").find(".modal-dialog").attr("data-modal-class");return d&&$("#ajaxModal").find(".modal-dialog").removeClass(d),$(this).each(function(){$.each(this.attributes,function(){this.specified&&this.name.match("^data-post-")&&(e[this.name.replace("data-post-","")]=this.value)})}),ajaxModalXhr=$.ajax({url:a,data:e,cache:!1,type:"POST",success:function(t){$("#ajaxModal").find(".modal-dialog").removeClass("mini-modal"),"1"===i?$("#ajaxModal").find(".modal-dialog").addClass("custom-modal-lg"):"1"===n&&$("#ajaxModal").find(".modal-dialog").addClass("modal-fullscreen"),"1"===r&&$("#ajaxModal").addClass("global-search-modal"),"1"===s&&$("#ajaxModal").find(".modal-dialog").addClass("custom-bg-modal"),l&&$("#ajaxModal").find(".modal-dialog").addClass(l).attr("data-modal-class",l),$("#ajaxModalContent").html(t),initAllNotEmptyWYSIWYGEditors(!0,$("#ajaxModalContent")),setModalScrollbar();for(let e=0;e<5;e++)setTimeout(function(){($modalBody=$("#ajaxModalContent").find(".modal-body")).length&&"1"!=$modalBody.data("scrollbar-added")&&setModalScrollbar()},100*(e+1));feather.replace()},statusCode:{403:function(){console.log("403: Session expired."),location.reload()},404:function(){$("#ajaxModalContent").find(".modal-body").html(""),appAlert.error("404: Page not found.",{container:".modal-body",animate:!1})}},error:function(){$("#ajaxModalContent").find(".modal-body").html(""),appAlert.error(AppLanugage.somethingWentWrong,{container:".modal-body",animate:!1})}}),!1}),$("#ajaxModal").on("hidden.bs.modal",function(t){t.target&&"ajaxModal"===t.target.id&&(ajaxModalXhr.abort(),$("#ajaxModal").find(".modal-dialog").removeClass("modal-lg"),$("#ajaxModal").find(".modal-dialog").addClass("modal-lg"),$("#ajaxModalContent").html(""))}),$("body").on("click show.bs.dropdown","[data-act=ajax-request]",function(){$(this).closest("td.all").length>0&&$(this).closest("td.all").trigger("click");var t={},e=$(this),a=e.attr("data-action-url"),i=e.attr("data-remove-on-success"),n=e.attr("data-remove-on-click"),s=e.attr("data-fade-out-on-success"),r=e.attr("data-fade-out-on-click"),o=e.attr("data-inline-loader"),l=e.attr("data-target-loader"),d=e.attr("data-reload-on-success"),c=e.attr("data-show-response"),p=e.attr("data-success-callback"),u=e.attr("data-content-type"),m="";if(e.attr("data-real-target")?m=$(e.attr("data-real-target")):e.attr("data-closest-target")&&(m=e.closest(e.attr("data-closest-target"))),!a)return console.log("Ajax Request: Set data-action-url!"),!1;n&&$(n).length&&$(n).remove(),r&&$(r).length&&$(r).fadeOut(function(){$(this).remove()});var f={};e.each(function(){$.each(this.attributes,function(){this.specified&&this.name.match("^data-post-")&&(t[this.name.replace("data-post-","")]=this.value),this.specified&&this.name.match("^data-header-")&&(f[this.name.replace("data-header-","")]=this.value)})}),"1"===o?e.addClass("spinning"):"1"===l?appLoader.show({container:m}):appLoader.show();var h={url:a,data:t,cache:!1,type:"POST",headers:f,success:function(a){"1"===o&&e.removeClass("spinning"),p&&void 0!==window[p]&&window[p](a,e),c&&a?a.success?(a.message&&appAlert.success(a.message,{duration:1e4}),d&&location.reload()):appAlert.error(a.message):d&&location.reload(),i&&$(i).length&&$(i).remove(),s&&$(s).length&&$(s).fadeOut(function(){$(this).remove()});var n=e.attr("data-request-group");n&&window.ajaxRequestHooks&&window.ajaxRequestHooks[n]&&window.ajaxRequestHooks[n].forEach(function(e){"function"==typeof e.onSuccess&&e.onSuccess(t)}),appLoader.hide(),m.length&&(e.attr("data-append")?(e.remove(),m.append(a)):m.html(a))},statusCode:{404:function(){appLoader.hide(),appAlert.error("404: Page not found.")}},error:function(){appLoader.hide(),appAlert.error(AppLanugage.somethingWentWrong)}};c&&(h.dataType="json"),"application/json"==u&&(h.contentType=u,h.data=JSON.stringify(h.data)),ajaxRequestXhr=$.ajax(h)}),$("body").on("click",'[data-bs-toggle="ajax-tab"] a',function(){var t=$(this),e=t.attr("href"),a=t.attr("data-bs-target");return!!a&&(t.attr("data-reload")&&$(a).html(""),(""===$(a).html()||t.attr("data-reload"))&&(appLoader.show({container:a,css:"right:50%; bottom:auto;"}),appAjaxRequest({url:e,cache:!1,type:"GET",success:function(t){$(a).html(t),feather.replace(),selectLastlySelectedTab(a)},statusCode:{403:function(){console.log("403: Session expired."),location.reload()},404:function(){appLoader.hide(),appAlert.error("404: Page not found.")}},error:function(){appLoader.hide(),appAlert.error(AppLanugage.somethingWentWrong)}})),t.tab("show"),!1)}),selectLastlySelectedTab(),$("body").on("click",'[data-toggle="app-modal"]',function(){var t=!0;return"0"===$(this).attr("data-sidebar")&&(t=!1),appContentModal.init({url:$(this).attr("data-url"),content_url:$(this).attr("data-content_url"),sidebar:t,sourceElement:$(this)}),!1});var t,e=function(t,e){var a=e.attr("data-success-callback");a&&void 0!==window[a]&&(window[a](t,e),t.message&&appAlert.warning(t.message,{duration:2e4}))},a=function(t){deleteConfirmationHandler(t,e)};$("body").on("click","a[data-action=delete-confirmation]:not(table a)",a)});var define,define,define,define,define,registerNewHook=function(t,e,a,i,n){if(!t||"function"!=typeof e)return!1;window[a]||(window[a]={}),window[a][t]||(window[a][t]=[]),i&&n&&(window[a][t]=window[a][t].filter(function(t){return!(t.hookType===i&&t.contextId===n)})),window[a][t].push({onSuccess:e,hookType:i,contextId:n})},registerAppFormHook=function(t,e,a,i){registerNewHook(t,e,"appFormHooks",a,i)},registerAjaxRequestHook=function(t,e,a,i){registerNewHook(t,e,"ajaxRequestHooks",a,i)},registerAppModifierHook=function(t,e,a,i){registerNewHook(t,e,"appModifierHooks",a,i)},registerAppTableRowUpdateHook=function(t,e,a,i){registerNewHook(t,e,"appTableRowUpdateHook",a,i)},registerAppTableRowDeleteHook=function(t,e,a,i){registerNewHook(t,e,"appTableRowDeleteHook",a,i)};function getWeekRange(t){t||(t=moment().customFormat("YYYY-MM-DD"));var e=moment(t).format("E")-AppHelper.settings.firstDayOfWeek,a={};return e<7?a.firstDateOfWeek=moment(t).subtract(e,"days").customFormat("YYYY-MM-DD"):a.firstDateOfWeek=moment(t).customFormat("YYYY-MM-DD"),e<0&&(a.firstDateOfWeek=moment(a.firstDateOfWeek).subtract(7,"days").customFormat("YYYY-MM-DD")),a.lastDateOfWeek=moment(a.firstDateOfWeek).add(6,"days").customFormat("YYYY-MM-DD"),a}function getFilterInfo(t){var e=null;return $.each(AppHelper.settings.filters||[],function(a,i){t===i.id&&(e=i)}),e}function getContextFilterInfo(t,e){var a=getFilterInfo(t),i=e.smartFilterIdentity,n=e.contextMeta?e.contextMeta.contextId:"";return a&&i&&a.context!==i&&a.context!==i+"_"+n&&(a=null),a}function getDynamicDateRanges(){return{today:[moment().customFormat("YYYY-MM-DD"),moment().customFormat("YYYY-MM-DD")],yesterday:[moment().subtract(1,"days").customFormat("YYYY-MM-DD"),moment().subtract(1,"days").customFormat("YYYY-MM-DD")],tomorrow:[moment().add(1,"days").customFormat("YYYY-MM-DD"),moment().add(1,"days").customFormat("YYYY-MM-DD")],last_7_days:[moment().subtract(6,"days").customFormat("YYYY-MM-DD"),moment().customFormat("YYYY-MM-DD")],next_7_days:[moment().customFormat("YYYY-MM-DD"),moment().add(6,"days").customFormat("YYYY-MM-DD")],last_30_days:[moment().subtract(29,"days").customFormat("YYYY-MM-DD"),moment().customFormat("YYYY-MM-DD")],this_month:[moment().startOf("month").customFormat("YYYY-MM-DD"),moment().endOf("month").customFormat("YYYY-MM-DD")],last_month:[moment().subtract(1,"month").startOf("month").customFormat("YYYY-MM-DD"),moment().subtract(1,"month").endOf("month").customFormat("YYYY-MM-DD")],next_month:[moment().add(1,"month").startOf("month").customFormat("YYYY-MM-DD"),moment().add(1,"month").endOf("month").customFormat("YYYY-MM-DD")],this_year:[moment().startOf("year").customFormat("YYYY-MM-DD"),moment().endOf("year").customFormat("YYYY-MM-DD")],next_year:[moment().add(1,"year").startOf("year").customFormat("YYYY-MM-DD"),moment().add(1,"year").endOf("year").customFormat("YYYY-MM-DD")],last_year:[moment().subtract(1,"year").startOf("year").customFormat("YYYY-MM-DD"),moment().subtract(1,"year").endOf("year").customFormat("YYYY-MM-DD")]}}function getDynamicDates(){return{today:moment().customFormat("YYYY-MM-DD"),yesterday:moment().subtract(1,"days").customFormat("YYYY-MM-DD"),tomorrow:moment().add(1,"days").customFormat("YYYY-MM-DD"),in_last_2_days:moment().subtract(2,"days").customFormat("YYYY-MM-DD"),in_last_7_days:moment().subtract(7,"days").customFormat("YYYY-MM-DD"),in_last_15_days:moment().subtract(15,"days").customFormat("YYYY-MM-DD"),in_next_7_days:moment().add(7,"days").customFormat("YYYY-MM-DD"),in_next_15_days:moment().add(15,"days").customFormat("YYYY-MM-DD"),in_last_30_days:moment().add(30,"days").customFormat("YYYY-MM-DD"),in_last_1_month:moment().subtract(1,"months").customFormat("YYYY-MM-DD"),in_last_3_months:moment().subtract(3,"months").customFormat("YYYY-MM-DD"),start_of_month:moment().startOf("month").customFormat("YYYY-MM-DD"),end_of_month:moment().endOf("month").customFormat("YYYY-MM-DD"),start_of_year:moment().startOf("year").customFormat("YYYY-MM-DD"),end_of_year:moment().endOf("year").customFormat("YYYY-MM-DD")}}function getContextFilters(t){var e=[],a=t.smartFilterIdentity,i=t.contextMeta?t.contextMeta.contextId:"",n="";return i&&(n=a+"_"+i),a&&$.each(AppHelper.settings.filters||[],function(t,i){(i.context===a||i.context===n)&&e.push(i)}),e.sort(function(t,e){var a=t.title.toLowerCase(),i=e.title.toLowerCase();return a<i?-1:a>i?1:0}),e}!function(t){t.fn.appForm=function(e){var a=t.extend({},{ajaxSubmit:!0,isModal:!0,closeModalOnSuccess:!0,dataType:"json",showLoader:!0,onModalClose:function(){},onSuccess:function(){},onError:function(){return!0},onSubmit:function(){},onAjaxSuccess:function(){},beforeAjaxSubmit:function(t,e,a){}},e);function i(t){if(t){var e=AppHelper.settings.dateFormat||"Y.m.d",e=e.toLowerCase(),a=e.charAt("1"),i=e.split(a),n=0,s=1,r=2;"y"===i[1]?n=1:"y"===i[2]&&(n=2),"m"===i[0]?s=0:"m"===i[2]&&(s=2),"d"===i[0]?r=0:"d"===i[1]&&(r=1);var o=t.split(a);return o[n]+"-"+o[s]+"-"+o[r]}}function n(e,a){t.validator.addMethod("greaterThanOrEqual",function(e,a,n){var s=n;return n&&(0===n.indexOf("#")||0===n.indexOf("."))&&(s=t(n).val()),void 0===t(a).attr("data-rule-required")&&!e||(/Invalid|NaN/.test(new Date(i(e)))?isNaN(e)&&isNaN(s)||Number(e)>=Number(s):!s||new Date(i(e))>=new Date(i(s)))},"Must be greater than {0}."),t.validator.addMethod("greaterThan",function(e,a,i){var n=i;return(i&&(0===i.indexOf("#")||0===i.indexOf("."))&&(n=t(i).val()),/Invalid|NaN/.test(new Number(e)))?isNaN(e)&&isNaN(n)||Number(e)>Number(n):new Number(e)>new Number(n)},"Must be greater than."),t.validator.addMethod("mustBeSameYear",function(e,a,n){var s=n;if(n&&(0===n.indexOf("#")||0===n.indexOf("."))&&(s=t(n).val()),!/Invalid|NaN/.test(new Date(i(e)))){var r=new Date(i(e)),o=new Date(i(s));return r&&o&&r.getFullYear()===o.getFullYear()}},"The year must be same for both dates."),t(e).validate({submitHandler:function(t){if(!a)return!0;a(t)},highlight:function(e){t(e).closest(".form-group").addClass("has-error")},unhighlight:function(e){t(e).closest(".form-group").removeClass("has-error")},errorElement:"span",errorClass:"help-block",ignore:":hidden:not(.validate-hidden)",errorPlacement:function(t,e){e.parent(".input-group").length?t.insertAfter(e.parent()):t.insertAfter(e)}}),t(".validate-hidden").click(function(){t(this).closest(".form-group").removeClass("has-error").find(".help-block").hide()})}function s(){var e=t(".modal-body").removeClass("hide");e.closest(".modal-dialog").find('[type="submit"]').removeAttr("disabled"),e.removeClass("hide"),t(".modal-mask").remove()}function r(e){e&&(t(".modal-mask").html("<div class='circle-done'><i data-feather='check' stroke-width='5'></i></div>"),setTimeout(function(){t(".modal-mask").find(".circle-done").addClass("ok")},30)),setTimeout(function(){t(".modal-mask").remove(),t("#ajaxModal").modal("toggle"),a.onModalClose()},1e3)}return this.each(function(){a.ajaxSubmit?n(t(this),function(e){var n,o,l;a.onSubmit(),a.isModal?(n=t("#ajaxModalContent").find(".modal-body"),o=n.height()-80,o>0&&(o=Math.floor(o/2)),n.after("<div class='modal-mask'><div class='circle-loader'></div></div>"),l=n.outerHeight(),t(".modal-mask").css({width:n.width()+22+"px",height:l+"px","padding-top":o+"px"}),n.closest(".modal-dialog").find('[type="submit"]').attr("disabled","disabled"),n.addClass("hide")):t(e).find('[type="submit"]').attr("disabled","disabled"),"1"===AppHelper.settings.enableRichTextEditor&&t("textarea").each(function(){var e=t(this);e.attr("data-rich-text-editor")&&"<p><br></p>"===e.val()&&e.val("")}),t(e).ajaxSubmit({dataType:a.dataType,beforeSubmit:function(n,r,o){var l=[],d={};if(t.each(n,function(t,e){e.data&&"1"==e.data.encode_ajax_post_data&&(n[t].value=encodeAjaxPostData(e.value)),e.data&&e.data.convertDateFormat&&e.value&&(n[t].value=i(e.value)),e.data&&"1"==e.data.prepare_checkboxes_data&&(d[e.name]?d[e.name].value+=d[e.name].value?", "+e.value:e.value?e.value:"":d[e.name]=e,l.push(t))}),Object.keys(d).forEach(t=>{n.push(d[t])}),l.length>0&&(n=n.filter(function(t,e){return!l.includes(e)})),!a.isModal&&a.showLoader&&appLoader.show({container:e,css:"top:2%; right:46%;"}),!1===a.beforeAjaxSubmit(n,r,o))return s(),!1;r.data("app_post_data",n)},success:function(i,n,o,l){if(a.onAjaxSuccess(i),i.success){if(a.onSuccess(i),a.isModal&&a.closeModalOnSuccess&&r(!0),a.isModal||t(e).find("textarea").each(function(){void 0!=t(this).attr("data-rich-text-editor")&&void 0==t(this).attr("data-keep-rich-text-editor-after-submit")&&destroyWYSIWYGEditor(t(this))}),l&&window.appFormHooks){var d=t(e).attr("id");if(d&&window.appFormHooks[d]){var c={};t.each(l.serializeArray(),function(){c[this.name]=this.value}),window.appFormHooks[d].forEach(function(t){"function"==typeof t.onSuccess&&t.onSuccess(c,i)})}}appLoader.hide()}else a.onError(i)&&(a.isModal?(s(),i.message&&appAlert.error(i.message,{container:".modal-body",animate:!1})):i.message&&appAlert.error(i.message));t(e).find('[type="submit"]').removeAttr("disabled")}})}):n(t(this))}),this.closeModal=function(){r(!0)},this}}(jQuery),function(t){t.fn.appDropdown=function(e){if("destroy"===e)return this.each(function(){var e=t(this);e.data("select2")&&e.select2("destroy")});var a=t.extend({},{list_data:[],showListAfterSearch:!1},e);return this.each(function(){var e=t(this),i={placeholder:e.attr("placeholder")};if(a.list_data&&a.list_data[0]){var n=a.list_data[0];"MAX_DROPDOWN_ITEMS_REACHED"==n.dropdown_type&&n.source_url&&(i.minimumInputLength=2,i.query=function(t){clearTimeout(this._t),this._t=setTimeout(function(){appAjaxRequest({url:n.source_url,type:"POST",dataType:"json",data:{search:t.term,blank_option_text:n.blank_option_text},success:function(e){t.callback({results:e})}})},350)},i.initSelection=function(t,a){e.val()?appAjaxRequest({url:n.source_url,type:"POST",dataType:"json",data:{id:e.val()},success:function(t){t&&t[0]&&t[0].id==e.val()&&t[0].text&&a({id:t[0].id,text:t[0].text})}}):n&&n.blank_option_text&&a({id:"",text:n.blank_option_text})},i.formatInputTooShort=function(){return AppLanugage.enterMinimum2characters})}if(e.is("select"))isMobile()&&e.find("option").length<20&&(i.minimumResultsForSearch=-1),a.onChangeCallback?e.select2(i).on("change",function(){var e=t(this);a.onChangeCallback(e.val(),e)}):e.select2(i);else if(e.is("input")){a.multiple?(e.data("multiple",1),i.multiple=!0):1==e.data("multiple")&&(i.multiple=!0),a.canCreateTags?i.tags=a.list_data:1==e.data("can-create-tags")?i.tags=a.list_data:i.data=a.list_data,a.escapeMarkup&&(i.escapeMarkup=a.escapeMarkup),isMobile()&&i.data&&i.data.length<20&&(i.minimumResultsForSearch=-1);var s=e.data();e.select2(i).on("change",function(){if(s.roload_dropdown_on_change&&s.roload_dropdown_on_change.split(",").forEach(function(e){var a=t(e);if(a.length){var i=a.data();if(i.source_url){var n={};i.post_field_values_of&&i.post_field_values_of.split(",").forEach(function(e){n[e]=t("[name='"+e+"']").val()}),a.data("select2")&&a.select2("destroy").val(""),appAjaxRequest({url:i.source_url,type:"POST",data:n,dataType:"json",success:function(t){var e={list_data:t};1==a.data("multiple")&&(e.multiple=!0),1==a.data("can-create-tags")&&(e.canCreateTags=!0),a.appDropdown(e)}})}}}),a.onChangeCallback){var e=t(this);a.onChangeCallback(e.val(),e)}})}})}}(jQuery);class DefaultFilters{constructor(t){return this.settings=t,this.init(),this.settings}init(){var t=getFilterIdFromCookie(this.settings);t&&this.settings.stateSave&&!this.settings.ignoreSavedFilter&&getContextFilterInfo(t,this.settings)?this.initSelectedFilter(t):(this.prepareDefaultDateRangeFilterParams(),this.prepareDefaultCheckBoxFilterParams(),this.prepareDefaultMultiSelectilterParams(),this.prepareDefaultRadioFilterParams(),this.prepareDefaultDropdownFilterParams(),this.prepareDefaultrSingleDatepickerFilterParams(),this.prepareDefaultrRngeDatepickerFilterParams(),this.prepareDefaultRangeRadioButtonsFilterParams(),this.prepareDefaultDynamicRangeFilterParams())}initSelectedFilter(t){if(t){var e={},a=getContextFilterInfo(t,this.settings);a&&(e=cloneDeep(a.params)),this.settings.filterParams=cloneDeep(e),this.applyInitialFilterHook()}}applyInitialFilterHook(){var t="";if($.each(this.settings.filterParams,function(e,a){"dynamic"==a&&(t=e)}),t&&this.settings.filterParams&&this.settings.filterParams[t+"_dynamic"]){var e=getDynamicDateRanges(),a=this.settings.filterParams[t+"_dynamic"];e&&e[a]&&(this.settings.filterParams.start_date=e[a][0],this.settings.filterParams.end_date=e[a][1])}}prepareDefaultDateRangeFilterParams(t){var e=this.settings;if(t||(t=e.dateRangeType),"daily"===t)e.filterParams.start_date=moment().customFormat(e._inputDateFormat),e.filterParams.end_date=e.filterParams.start_date;else if("monthly"===t){var a=moment().daysInMonth(),i=moment().customFormat("YYYY-MM");e.filterParams.start_date=i+"-01",e.filterParams.end_date=i+"-"+a}else if("yearly"===t){var n=moment().customFormat("YYYY");e.filterParams.start_date=n+"-01-01",e.filterParams.end_date=n+"-12-31"}else if("weekly"===t){var s=getWeekRange();e.filterParams.start_date=s.firstDateOfWeek,e.filterParams.end_date=s.lastDateOfWeek}this.settings=e}prepareDefaultCheckBoxFilterParams(){var t=this.settings,e=[],a="";$.each(t.checkBoxes,function(t,i){a=i.name,i.isChecked&&e.push(i.value)}),t.filterParams[a]=e,this.settings=t}prepareDefaultMultiSelectilterParams(){var t=this.settings;$.each(t.multiSelect,function(e,a){var i=a.saveSelection,n=getCookie(a.name),s=[];i&&n?s=n=n.split("-"):$.each(a.options,function(t,e){e.isChecked&&s.push(e.value)}),t.filterParams[a.name]=s}),this.settings=t}prepareDefaultRadioFilterParams(){var t=this.settings;$.each(t.radioButtons,function(e,a){a.isChecked&&(t.filterParams[a.name]=a.value)}),this.settings=t}prepareDefaultDropdownFilterParams(){var t=this.settings;$.each(t.filterDropdown||[],function(e,a){a.value?t.filterParams[a.name]=a.value:$.each(a.options,function(e,i){i.isSelected&&(t.filterParams[a.name]=i.id)})}),this.settings=t}prepareDefaultrSingleDatepickerFilterParams(){var t=this.settings;$.each(t.singleDatepicker||[],function(e,a){$.each(a.options||[],function(e,i){i.isSelected&&(t.filterParams[a.name]=i.value)})}),this.settings=t}prepareDefaultrRngeDatepickerFilterParams(){var t=this.settings;$.each(t.rangeDatepicker||[],function(e,a){a.startDate&&a.startDate.value&&(t.filterParams[a.startDate.name]=a.startDate.value),a.startDate&&a.endDate.value&&(t.filterParams[a.endDate.name]=a.endDate.value)}),this.settings=t}prepareDefaultRangeRadioButtonsFilterParams(){var t=this.settings,e=this;$.each(t.rangeRadioButtons||[],function(a,i){i.selectedOption&&(t.filterParams[i.name]=i.selectedOption,e.prepareDefaultDateRangeFilterParams(i.selectedOption))}),this.settings=t}prepareDefaultDynamicRangeFilterParams(){var t=this.settings;$.each(t.rangeRadioButtons||[],function(e,a){if(a.dynamicRanges){var i=a.name+"_dynamic";t.filterParams[i]=a.selectedDynamicRange||a.dynamicRanges[0]}}),this.settings=t}}var prepareDefaultFilters=function(t){return new DefaultFilters(t)};function cloneDeep(t){if("object"!=typeof t||null===t)return t;let e;if(Array.isArray(t)){e=[];for(let a=0;a<t.length;a++)e[a]=cloneDeep(t[a])}else for(let i in e={},t)t.hasOwnProperty(i)&&(e[i]=cloneDeep(t[i]));return e}function getFilterIdFromCookie(t){var e=AppHelper.userId?AppHelper.userId:"public";return getCookie("filter_"+t.smartFilterIdentity+"_"+e)}class BuildFilters{constructor(t,e,a){this.leftFilterSectionClsss=".filter-section-left",this.rightFilterSectionClsss=".filter-section-right",this.filterFormClass=".filter-form",this.settings=t,this.$instanceWrapper=e,this.$instance=a,this.randomId=getRandomAlphabet(5),this.filterElements=[],this.activeFilterId="",this.state="new_filter"}init(){this.prepareSurchOption(),this.prepareReloadButton(),this.prepareSmartFilterDropdown(),this.prepareFilterFormShowButton(),this.prepareBookmarkFilterButtons(),this.hideFilterForm(),this.prepareDropdownFilters(),this.prepareDateRangePicker(),this.prepareDatePickerFilter(),this.prepareSingleDatePicker(),this.prepareMultiselectFilter(),this.prepareCheckboxFilter(),this.prepareRadioFilter(),this.prepareRangeRadioButtons(),this.prepareSaveFilterButton(),this.prepareCancelFilterFormButton(),this.initActiveFilterFromCookie(),this.prepareSelectionHandler(),window.Filters||(window.Filters=[]),window.Filters[this.settings.smartFilterIdentity]=this}saveSelectedFilter(){var t=AppHelper.userId?AppHelper.userId:"public";setCookie("filter_"+this.settings.smartFilterIdentity+"_"+t,this.activeFilterId)}initActiveFilterFromCookie(){if(this.settings.stateSave&&!this.settings.ignoreSavedFilter){var t=getFilterIdFromCookie(this.settings);t&&getContextFilterInfo(t,this.settings)&&(this.activeFilterId=t,this.applySelectedFilter(t,!1))}}reloadInstance(){this.$instance.is("table")?this.$instance.appTable({reload:!0,filterParams:this.settings.filterParams}):(this.$instance.appFilters({reload:!0,filterParams:this.settings.filterParams}),$(this.settings.targetSelector).trigger("reset-selection-menu"))}prepareSelectionHandler(){var t=this,e=t.settings.selectionHandler;if(!e)return!1;var a="kanban",i=null,n=null;t.$instanceWrapper.hasClass("dataTables_wrapper")&&(a="table",i=t.$instanceWrapper,n=t.$instanceWrapper.find(".dataTable")),"kanban"==a&&(i=t.$instance,n=$(t.settings.targetSelector));var s=t.settings.selectionHandler.hideButton,r="";s&&(r="hide");var o="<div class='dropdown btn-group mr5 hidden-xs'><button class='btn btn-default dropdown-toggle selection-handler-dropdown-btn "+r+"' type='button' data-bs-toggle='dropdown' aria-expanded='true' data-view_type='"+a+"'><i data-feather='crosshair' class='icon-16'></i></button><ul class='dropdown-menu' role='menu'>",l=e.postData,d="";l&&$.each(l,function(t,e){d="data-post-"+t+'="'+e+'" '}),o+="<li role='presentation'><a href='#' class='dropdown-item select-all-btn'>"+AppLanugage.selectAll+"</a></li>",o+="<li role='presentation'><a href='#' class='dropdown-item select-specific-btn'>"+AppLanugage.selectSpecific+"</a></li>",t.settings.selectionHandler.batchUpdateUrl&&(o+="<li role='presentation'><a class='dropdown-item batch-update-btn hide' data-act='ajax-modal' data-action-url='' "+d+" data-title='"+AppLanugage.batchUpdate+"' type='button'>"+AppLanugage.batchUpdate+"</a></li>"),t.settings.selectionHandler.batchDownloadUrl&&(o+="<li role='presentation'><a class='dropdown-item download-selected-btn hide' data-action-url='' data-title='"+AppLanugage.downloadSelectedItems+"' type='button'>"+AppLanugage.downloadSelectedItems+"</a></li>"),t.settings.selectionHandler.batchDeleteUrl&&(o+="<li role='presentation'><a class='dropdown-item delete-selected-btn hide' data-action-url='' data-title='"+AppLanugage.deleteSelectedItems+"' type='button' data-action = 'delete-confirmation' data-reload-on-success = 'true'>"+AppLanugage.deleteSelectedItems+"</a></li>"),o+="<li role='presentation'><a href='#' class='dropdown-item clear-selection-btn hide'>"+AppLanugage.clearSelection+"</a></li>",o+="</ul></div>",t.$instanceWrapper.find(".filter-section-right").prepend(o);var c=[],p=!1;$(".select-specific-btn").on("click",function(){u(n)});var u=function(t,e=!0){e?(t.addClass("js-selection-mode"),m(t),p=!0):(t.removeClass("js-selection-mode"),f(t),p=!1)},m=function(t){t.hasClass("dataTable")?t.find("a").addClass("pe-none"):t.find('[data-act="ajax-modal"]').attr("data-act","ajax-modal-disabled"),t.find(".selection-pe-none").addClass("pe-none")},f=function(t){t.hasClass("dataTable")?t.find("a").removeClass("pe-none"):t.find('[data-act="ajax-modal-disabled"]').attr("data-act","ajax-modal"),t.find(".selection-pe-none").removeClass("pe-none")};i.find(".select-all-btn").on("click",function(){var e;u(n),(e=n.hasClass("dataTable")?n.find("tbody tr"):n.find(".kanban-item")).each(function(){if($(this).addClass("batch-operation-selected"),n.hasClass("dataTable"))var t=$(this).find(".js-selection-id").data("id");else var t=$(this).data("id");c.includes(t)||c.push(t)}),t.updateSelection(i,n,c),i.find(".clear-selection-btn").removeClass("hide")}),n.on("click","tbody tr",function(){var t=$(this),e=t.find(".js-selection-id").data("id");h(t,e,i,n)}),n.on("click",".kanban-item",function(){var t=$(this),e=t.data("id");h(t,e,i,n)});var h=function(e,a,i,n){if(!p)return!1;if(-1!==$.inArray(a,c)){var s=c.indexOf(a);c.splice(s,1),e.removeClass("batch-operation-selected")}else c.push(a),e.addClass("batch-operation-selected");t.updateSelection(i,n,c),i.find(".clear-selection-btn").removeClass("hide")};i.find(".clear-selection-btn").on("click",function(){v()}),n.on("reset-selection-menu",function(){v()});var v=function(){var e;u(n,!1),(e=n.hasClass("dataTable")?n.find("tbody tr"):n.find(".kanban-item")).each(function(){if($(this).removeClass("batch-operation-selected"),n.hasClass("dataTable"))var t=$(this).find(".js-selection-id").data("id");else var t=$(this).data("id");c=c.filter(e=>e!==t)}),i.find(".clear-selection-btn").addClass("hide"),t.updateSelection(i,n,c)}}updateSelection(t,e,a){a.length?(t.find(".batch-update-btn").removeClass("hide"),t.find(".delete-selected-btn").removeClass("hide"),t.find(".selection-handler-dropdown-btn").addClass("active")):(t.find(".batch-update-btn").addClass("hide"),t.find(".delete-selected-btn").addClass("hide"),t.find(".selection-handler-dropdown-btn").removeClass("active")),(i=e.hasClass("dataTable")?e.find("tbody tr"):e.find(".kanban-item")).length===a.length&&0!==a.length?t.find(".select-all-btn").addClass("hide"):t.find(".select-all-btn").removeClass("hide"),0===a.length?t.find(".select-specific-btn").removeClass("hide"):t.find(".select-specific-btn").addClass("hide");var i,n=a.join("-"),s=this.settings.selectionHandler.batchUpdateUrl;s&&t.find(".batch-update-btn").attr("data-action-url",s).attr("data-post-ids",n);var r=this.settings.selectionHandler.batchDeleteUrl;r&&t.find(".delete-selected-btn").attr("data-action-url",r).attr("data-post-ids",n)}prepareSmartFilterDropdown(){if(this.settings.smartFilterIdentity){var t=this,e=" data-post-context='"+t.settings.smartFilterIdentity+"'  data-post-instance_id='"+t.getInstanceId()+"' ";t.getContextId()&&(e+=" data-post-context_id= '"+t.getContextId()+"' ");var a=AppHelper.baseUrl+"index.php/filters/manage_modal/"+t.settings.smartFilterIdentity,i='<div class=\'dropdown-menu w300\'><div class="pb10 pl10"><a class="inline-block btn btn-default manage-filters-button" data-act="ajax-modal" data-title="'+AppLanugage.manageFilters+'" '+e+'  type="button" data-action-url="'+a+'" ><i data-feather="tool" class="icon-16 mr5"></i>'+AppLanugage.manageFilters+' </a><a class="inline-block btn btn-default clear-filter-button ml10 hide" href="#"><i data-feather="delete" class="icon-16 mr5"></i>'+AppLanugage.clear+'</a></div><input type="text" class="form-control search-filter" placeholder="'+AppLanugage.search+'"><div class="dropdown-divider"></div><ul class=\'list-group smart-filter-list-group\'></ul></div>';this.$instanceWrapper.find(t.leftFilterSectionClsss).append('<div class="filter-item-box smart-filter-dropdown-box"><div class="dropdown smart-filter-dropdown-container"><button class="btn btn-default smart-filter-dropdown dropdown-toggle caret" type="button" data-bs-toggle="dropdown" aria-expanded="true"></button>'+i+"</div></div>"),this.refreshFilterDropdown(),this.$instanceWrapper.find(".smart-filter-dropdown-container").on("click",".smart-filter-item",function(){var e=($(this).data()||{}).id;t.state="new_filter",t.applySelectedFilter(e)});var n=this.$instanceWrapper.find(".search-filter"),s=this.$instanceWrapper.find(".smart-filter-dropdown-container"),r=function(){var e=t.$instanceWrapper.find(".smart-filter-list-group"),a=t.$instanceWrapper.find(".smart-filter-item.active");if(t.$instanceWrapper.find(".smart-filter-item:visible").length>6){e.css({"overflow-y":"scroll",height:"270px"});var i=a.offset()?a.offset().top:0,n=e.offset()?e.offset().top:0;i-n>e.height()&&e.scrollTop(i-n)}else e.css({"overflow-y":"scroll",height:"auto"})};s.on("show.bs.dropdown",function(){setTimeout(function(){r(),n.val("").focus(),t.$instanceWrapper.find(".smart-filter-item.active").length||t.$instanceWrapper.find(".smart-filter-item").first().addClass("active")})}),n.on("input",function(e){var a=t.$instanceWrapper.find(".smart-filter-item"),i=$(this).val().toLowerCase(),n=!1;a.each(function(){var t=$(this).html().toLowerCase(),e=!0;t.includes(i)?($(this).parent().removeClass("hide"),n||($(this).addClass("active"),n=!0,e=!1)):$(this).parent().addClass("hide"),e&&$(this).removeClass("active")}),r()}),n.on("keydown",function(e){var a=t.$instanceWrapper.find(".smart-filter-item.active");40===e.keyCode?(e.preventDefault(),a.parent().nextAll(":visible").length&&(a.removeClass("active"),a=a.parent().nextAll(":visible").first().find("a").addClass("active"))):38===e.keyCode?(e.preventDefault(),a.parent().prevAll(":visible").length&&(a.removeClass("active"),a=a.parent().prevAll(":visible").first().find("a").addClass("active"))):13===e.keyCode&&(e.preventDefault(),t.$instanceWrapper.find(".smart-filter-item.active").trigger("click"),s.dropdown("toggle"));var i=t.$instanceWrapper.find(".smart-filter-list-group");a.length&&a.offset().top+a.outerHeight()-i.offset().top>i.height()?i.scrollTop(i.scrollTop()+a.outerHeight()):a.length&&a.offset().top-i.offset().top<0&&i.scrollTop(i.scrollTop()-a.outerHeight())}),this.$instanceWrapper.find(".clear-filter-button").click(function(){t.activeFilterId="",t.clearAllFilters(),t.refreshFilterDropdown(),t.reloadInstance(),t.saveSelectedFilter()})}}initChangeFilter(t){this.activeFilterId=t,this.showFilterForm(),this.state="change_filter",this.applySelectedFilter(t)}applySelectedFilter(t,e=!0){var a=this;if(t){a.activeFilterId=t;var i=[],n=getContextFilterInfo(t,this.settings);a.settings.filterParams=cloneDeep(n.params),i=cloneDeep(n.params);var s=[];for(var r in i=function(t){var e={},a=Object.keys(t).find(e=>"dynamic"===t[e]),i="";for(var n in t)t.hasOwnProperty(n)&&n!==a&&(e[n]=t[n]),t.hasOwnProperty(n)&&n.endsWith("_dynamic")&&(i=n.slice(0,-8));return a&&(e[a]=t[a]),i&&"dynamic"!=t[i]&&delete e[i+"_dynamic"],e}(i),$.each(i,function(t,e){s.push(t);var n=a.filterElements[t];n&&n.setValue(e,cloneDeep(i))}),a.filterElements)if(!s.includes(r)){var o=a.filterElements[r];o&&o.setValue("")}a.refreshFilterDropdown(),!1!==e&&a.reloadInstance(),a.showHideClearFilterButton(),a.updateFilterModalState(n),a.saveSelectedFilter()}}refreshFilterDropdown(){var t="",e=this,a=e.getFilters(),i="";$.each(a,function(a,n){var s="";n.id===e.activeFilterId&&(s="active",i=n.title),t+='<li><a href="#" class="dropdown-item smart-filter-item list-group-item clickable '+s+' "data-id="'+n.id+'">',t+=n.title,t+="</a></li>"}),this.$instanceWrapper.find(".smart-filter-list-group").html(t),i||(i=AppLanugage.filters);var n='<i data-feather="filter" class="icon-16 mr5"></i>'+i;this.$instanceWrapper.find(".smart-filter-dropdown").html(n),a.length?(this.$instanceWrapper.find(".smart-filter-dropdown-container").removeClass("hide").closest(".filter-item-box").css("position","initial"),this.$instanceWrapper.find(".show-filter-form-button").find(".add-filter-text").addClass("hide")):(this.$instanceWrapper.find(".smart-filter-dropdown-container").addClass("hide").closest(".filter-item-box").css("position","absolute"),this.$instanceWrapper.find(".show-filter-form-button").find(".add-filter-text").removeClass("hide")),feather.replace()}getFilters(){return getContextFilters(this.settings)}prepareSurchOption(){var t=this.settings,e=this;if(t.search&&!1!==t.search.show){var a,i='<div class="filter-item-box"><input type="search" class="custom-filter-search" name="'+t.search.name+'" placeholder="'+t.customLanguage.searchPlaceholder+'"></div>';e.$instanceWrapper.find(e.rightFilterSectionClsss).append(i),e.$instanceWrapper.find(".custom-filter-search").keyup(function(){appLoader.show();var i=$(this);clearTimeout(a),a=setTimeout(function(){e.settings.filterParams[t.search.name]=i.val(),e.reloadInstance()},700)})}}prepareCollapsePannelButton(){if(this.settings.isMobile&&!this.settings.smartFilterIdentity&&(this.settings.dateRangeType||void 0!==this.settings.checkBoxes[0]||void 0!==this.settings.multiSelect[0]||void 0!==this.settings.radioButtons[0]||void 0!==this.settings.singleDatepicker[0]||void 0!==this.settings.rangeDatepicker[0]||void 0!==this.settings.filterDropdown[0])){var t="<div class='float-end filter-collapse-button'>                        <button title='"+AppLanugage.filters+"' class='dropdown-toggle btn btn-default mt0' data-bs-toggle='collapse' data-bs-target='#table-collapse-filter-"+this.randomId+"' aria-expanded='false'><i data-feather='sliders' class='icon-18'></i></button>                    </div>                    <div id='table-collapse-filter-"+this.randomId+"' class='navbar-collapse collapse w100p'></div>";this.$instanceWrapper.find(this.leftFilterSectionClsss).append(t)}}prepareReloadButton(){var t=this;if(t.settings.reloadSelector){if(!$(t.settings.reloadSelector).length){var e='<div class="filter-item-box reload-button-container"><button class="btn btn-default" id="'+t.settings.reloadSelector.slice(1)+'"><i data-feather="refresh-cw" class="icon-16"></i></button></div>';this.$instanceWrapper.find(this.leftFilterSectionClsss).append(e)}$(t.settings.reloadSelector).length&&$(t.settings.reloadSelector).click(function(){appLoader.show(),t.reloadInstance()})}}showHideClearFilterButton(){this.activeFilterId?this.$instanceWrapper.find(".clear-filter-button").removeClass("hide"):this.$instanceWrapper.find(".clear-filter-button").addClass("hide")}clearAllFilters(){var t=this;for(var e in t.activeFilterId="",this.filterElements){var a=t.filterElements[e];t.settings.filterParams[e]="",a&&a.setValue("")}t.showHideClearFilterButton()}prepareFilterFormShowButton(){if(this.settings.smartFilterIdentity){var t=this.getFilters(),e='<span class="add-filter-text ml5">'+AppLanugage.addNewFilter+"</span>";t.length?e="":this.$instanceWrapper.find(".smart-filter-dropdown-container").addClass("hide").closest(".filter-item-box").css("position","absolute");var a='<div class="filter-item-box show-hide-filter-button-box"><button class="btn btn-default show-filter-form-button" type="button"><i data-feather="plus" class="icon-16"></i>'+e+"</button></div>",i=this;this.$instanceWrapper.find(this.leftFilterSectionClsss).append(a),this.$instanceWrapper.find(".show-filter-form-button").click(function(){i.$instanceWrapper.find(i.filterFormClass).hasClass("hide")?i.showFilterForm():i.hideFilterForm()});var i=this;setTimeout(function(){var t,e=!1,a=AppHelper&&AppHelper.settings&&AppHelper.settings.filterBar?AppHelper.settings.filterBar:"";if("always_expanded"===a)e=!0;else if("expanded_until_saved_filter_selected"===a){getContextFilterInfo(getFilterIdFromCookie(i.settings),i.settings)||(e=!0)}e&&!(i.settings.isMobile||i.settings.mobileMirror)&&i.$instanceWrapper.find(".show-filter-form-button").trigger("click")})}}prepareBookmarkFilterButtons(){if(this.settings.smartFilterIdentity){var t=this;t.refreshBookmarkFilterButtons(),t.$instanceWrapper.find(".filter-section-container").on("click",".bookmarked-filter-button",function(){var e=($(this).data()||{}).id;t.state="new_filter",t.applySelectedFilter(e)})}}refreshBookmarkFilterButtons(){if(this.settings.smartFilterIdentity){var t=this,e=t.getFilters();t.$instanceWrapper.find(".bookmarked-filter-button-wrapper").remove(),t.$instanceWrapper.find(t.leftFilterSectionClsss).append("<div class='bookmarked-filter-button-container scrollable-container'></div>"),$.each(e,function(e,a){if("1"==a.bookmark){var i=a.title;a.icon&&(i='<i data-feather="'+a.icon+'" class="icon-16"></i>');var n='<div class="filter-item-box bookmarked-filter-button-wrapper"><button class="btn btn-default bookmarked-filter-button round" type="button" data-id="'+a.id+'"  >'+i+"</button></div>";t.$instanceWrapper.find(t.leftFilterSectionClsss).find(".bookmarked-filter-button-container").append(n)}}),feather.replace()}}hideFilterForm(){this.state="new_filter",this.$instanceWrapper.find(this.filterFormClass).addClass("hide"),this.showFilterFormButton()}showFilterForm(){this.$instanceWrapper.find(this.filterFormClass).removeClass("hide"),this.hideFilterFormButton(),this.showSaveFilterButton(),this.updateFilterModalState()}hideFilterFormButton(){var t=this.$instanceWrapper.find(".show-filter-form-button").closest(".filter-item-box");t.find(".add-filter-text").html()?t.addClass("hide"):t.find("button").find("svg").css({transform:"rotate(45deg)",transition:"all 0.2s ease 0s"})}showFilterFormButton(){var t=this.$instanceWrapper.find(".show-filter-form-button").closest(".filter-item-box");t.find(".add-filter-text").html()?t.removeClass("hide"):t.find("button").find("svg").css("transform","rotate(0deg)")}updateFilterModalState(t){var e=AppLanugage.newFilter,a=this.$instanceWrapper.find(".save-filter-button");"change_filter"===this.state?(e=AppLanugage.updateFilter,t&&(e+=" ("+t.title+")"),a.attr("data-title",e),a.attr("data-post-id",this.activeFilterId),a.attr("data-post-change_filter","1")):(a.attr("data-title",e),a.attr("data-post-id",getRandomAlphabet(10)),a.attr("data-post-change_filter",""))}showSaveFilterButton(){this.getFilters().length?this.$instanceWrapper.find(".save-filter-button").addClass("btn-default").removeClass("btn-success"):this.$instanceWrapper.find(".save-filter-button").addClass("btn-success").removeClass("btn-default"),this.$instanceWrapper.find(".save-filter-button").closest(".filter-item-box").removeClass("hide")}hideSaveSelectedFilterButton(){this.$instanceWrapper.find(".save-filter-button").closest(".filter-item-box").addClass("hide")}getInstanceId(){return this.$instance.attr("id")}getContextId(){return this.settings.contextMeta&&this.settings.contextMeta.contextId?this.settings.contextMeta.contextId:""}getContextDependencies(){return this.settings.contextMeta&&this.settings.contextMeta.dependencies?this.settings.contextMeta.dependencies:""}prepareSaveFilterButton(){if(this.settings.smartFilterIdentity){var t=" data-post-context='"+this.settings.smartFilterIdentity+"'  data-post-instance_id='"+this.getInstanceId()+"' ";this.getContextId()&&(t+=" data-post-context_id= '"+this.getContextId()+"' ");var e='<div class="filter-item-box save-filter-box hide"><button class="btn btn-default save-filter-button" data-act="ajax-modal" data-title="" '+t+'  type="button" data-action-url="'+AppHelper.baseUrl+'index.php/filters/modal_form" ><i data-feather="check-circle" class="icon-16"></i></button></div>';this.$instanceWrapper.find(this.filterFormClass).append(e)}}prepareCancelFilterFormButton(){if(this.settings.smartFilterIdentity){var t=this;this.$instanceWrapper.find(this.filterFormClass).append('<div class="filter-item-box filter-cancel-box"><button class="btn btn-default cancel-filter-button" type="button" ><i data-feather="x-circle" class="icon-16"></i></button></div>'),this.$instanceWrapper.find(".cancel-filter-button").click(function(){t.hideFilterForm()})}}appendFilterDom(t,e=!1){this.settings.smartFilterIdentity?e?this.$instanceWrapper.find(".range-radio-button").after(t):this.$instanceWrapper.find(this.filterFormClass).append(t):this.$instanceWrapper.find(this.leftFilterSectionClsss).append(t)}prepareDateRangePicker(t=!1){var e=this,a=this.settings,i=(this.$instance,this.$instanceWrapper);if(a.dateRangeType){var n='<div class="filter-item-box btn-group"><button data-act="prev" class="btn btn-default date-range-selector"><i data-feather="chevron-left" class="icon"></i></button><button data-act="datepicker" class="btn btn-default"></button><button data-act="next"  class="btn btn-default date-range-selector"><i data-feather="chevron-right" class="icon"></i></button></div>';t?this.appendFilterDom(n,!0):this.appendFilterDom(n);var s=i.find("[data-act='datepicker']"),r=i.find(".date-range-selector");if("daily"===a.dateRangeType){var o=function(t){a.filterParams.start_date===moment().customFormat(a._inputDateFormat)?t.html(a.customLanguage.today):a.filterParams.start_date===moment().subtract(1,"days").customFormat(a._inputDateFormat)?t.html(a.customLanguage.yesterday):a.filterParams.start_date===moment().add(1,"days").customFormat(a._inputDateFormat)?t.html(a.customLanguage.tomorrow):t.html(moment(a.filterParams.start_date).format("Do MMMM YYYY"))};o(s),s.datepicker({format:a._inputDateFormat,autoclose:!0,todayHighlight:!0,language:"custom",orientation:"bottom"}).on("changeDate",function(t){var i=moment(t.date).customFormat(a._inputDateFormat);a.filterParams.start_date=i,a.filterParams.end_date=i,o(s),e.reloadInstance()}),r.click(function(){var t=$(this).attr("data-act"),i="";"next"===t?i=moment(a.filterParams.start_date).add(1,"days").customFormat(a._inputDateFormat):"prev"===t&&(i=moment(a.filterParams.start_date).subtract(1,"days").customFormat(a._inputDateFormat)),a.filterParams.start_date=i,a.filterParams.end_date=i,o(s),e.reloadInstance()}),e.filterElements.start_date={setValue:function(t){s.datepicker("update",t),o(s)}}}if("monthly"===a.dateRangeType){var l=function(t){t.html(moment(a.filterParams.start_date).format("MMMM YYYY"))};l(s),s.datepicker({format:"YYYY-MM",viewMode:"months",minViewMode:"months",autoclose:!0,language:"custom",orientation:"bottom"}).on("changeDate",function(t){var i=moment(t.date).customFormat(a._inputDateFormat),n=moment(i).daysInMonth(),r=moment(i).customFormat("YYYY-MM");a.filterParams.start_date=r+"-01",a.filterParams.end_date=r+"-"+n,l(s),e.reloadInstance()}),r.click(function(){var t=$(this).attr("data-act"),i=moment(a.filterParams.start_date),n=moment(a.filterParams.end_date);if("next"===t){var r=i.add(1,"months"),o=r.daysInMonth(),d=r.customFormat("YYYY-MM");i=d+"-01",n=d+"-"+o}else if("prev"===t){var c=i.subtract(1,"months"),o=c.daysInMonth(),d=c.customFormat("YYYY-MM");i=d+"-01",n=d+"-"+o}a.filterParams.start_date=i,a.filterParams.end_date=n,l(s),e.reloadInstance()}),e.filterElements.start_date={setValue:function(t){s.datepicker("update",t),l(s)}}}if("yearly"===a.dateRangeType){var d=function(t){t.html(moment(a.filterParams.start_date).customFormat("YYYY"))};d(s),s.datepicker({format:"YYYY-MM",viewMode:"years",minViewMode:"years",autoclose:!0,language:"custom",orientation:"bottom"}).on("changeDate",function(t){var i=moment(t.date).customFormat(a._inputDateFormat),n=moment(i).customFormat("YYYY");a.filterParams.start_date=n+"-01-01",a.filterParams.end_date=n+"-12-31",d(s),e.reloadInstance()}),r.click(function(){var t=$(this).attr("data-act"),i=moment(a.filterParams.start_date),n=moment(a.filterParams.end_date);"next"===t?(i=i.add(1,"years").customFormat(a._inputDateFormat),n=n.add(1,"years").customFormat(a._inputDateFormat)):"prev"===t&&(i=i.subtract(1,"years").customFormat(a._inputDateFormat),n=n.subtract(1,"years").customFormat(a._inputDateFormat)),a.filterParams.start_date=i,a.filterParams.end_date=n,d(s),e.reloadInstance()}),e.filterElements.start_date={setValue:function(t){s.datepicker("update",t),d(s)}}}if("weekly"===a.dateRangeType){var c=function(t){var e=moment(a.filterParams.start_date).format("Do MMM"),i=moment(a.filterParams.end_date).format("Do MMM, YYYY");s.datepicker({format:"YYYY-MM-DD",autoclose:!0,calendarWeeks:!0,language:"custom",orientation:"bottom",weekStart:AppHelper.settings.firstDayOfWeek}),t.html(e+" - "+i)};c(s),r.click(function(){var t=$(this).attr("data-act"),i=moment(a.filterParams.start_date),n=moment(a.filterParams.end_date);"next"===t?(i=i.add(7,"days").customFormat(a._inputDateFormat),n=n.add(7,"days").customFormat(a._inputDateFormat)):"prev"===t&&(i=i.subtract(7,"days").customFormat(a._inputDateFormat),n=n.subtract(7,"days").customFormat(a._inputDateFormat)),a.filterParams.start_date=i,a.filterParams.end_date=n,c(s),e.reloadInstance()}),s.datepicker({format:a._inputDateFormat,autoclose:!0,calendarWeeks:!0,language:"custom",weekStart:AppHelper.settings.firstDayOfWeek}).on("show",function(){$(".datepicker").addClass("week-view"),$(".datepicker-days").find(".active").siblings(".day").addClass("active")}).on("changeDate",function(t){var i=getWeekRange(t.date);a.filterParams.start_date=i.firstDateOfWeek,a.filterParams.end_date=i.lastDateOfWeek,c(s),e.reloadInstance()}),e.filterElements.start_date={setValue:function(t){s.datepicker("update",t),c(s)}}}}}prepareDropdownFilters(){var t=this.settings,e=this,a=this.$instanceWrapper;void 0!==t.filterDropdown[0]&&$.each(t.filterDropdown,function(i,n){var s="",r="";n.value?s=n.value:$.each(n.options,function(t,e){e.isSelected&&(s=e.id)}),n.options&&n.options[0]&&!n.options[0].id&&n.options[0].text&&(r=n.options[0].text),n.name&&(t.filterParams[n.name]=s);var o='<div class="filter-item-box"><input class="'+n.class+'" name="'+n.name+'" value="'+s+'" placeholder="'+r+'" /></div>';e.appendFilterDom(o);var l=a.find("[name='"+n.name+"']"),d=function(a){var i=a.attr("name"),s=a.val();t.filterParams[i]=s,n.dependent&&n.dependent.length&&e.prepareDependentFilter(i,s,t.filterDropdown,t.filterParams),n.onChangeCallback&&n.onChangeCallback(s,t.filterParams),e.reloadInstance()};if(void 0!==window.Select2){var c={list_data:n.options,onChangeCallback:function(t,e){d(e)}};n.showHtml&&(c.escapeMarkup=function(t){return t}),l.appDropdown(c)}e.filterElements[n.name]={setValue:function(a,i){l.select2("val",a),n.showHtml&&!a&&n.options&&n.options[0]&&!n.options[0].id&&n.options[0].text&&l.siblings(".select2-container").find(".select2-chosen").html(n.options[0].text),window[n.name]=l,n.dependent&&n.dependent.length&&e.prepareDependentFilter(n.name,a,t.filterDropdown,t.filterParams,i),n.onChangeCallback&&n.onChangeCallback(a,i)}}})}getDynamicDateRanges(){return getDynamicDateRanges()}prepareDatePickerFilter(t=!1){var e=this.settings,a=this,i=(this.$instance,this.$instanceWrapper);void 0!==e.rangeDatepicker[0]&&$.each(e.rangeDatepicker,function(n,s){var r=s.startDate||{},o=s.endDate||{},l=!!s.showClearButton,d='<i data-feather="calendar" class="icon-16"></i>',c=r.value?moment(r.value,e._inputDateFormat).format("Do MMMM YYYY"):d,p=o.value?moment(o.value,e._inputDateFormat).format("Do MMMM YYYY"):d;e.filterParams[r.name]=r.value,e.filterParams[o.name]=o.value;var u=function(t,i){e.filterParams[t]=i,a.reloadInstance()},m=a.getDynamicDateRanges(),f='<span class="input-group-addon">-</span>',h=!1;if(s.label&&(f='<span class="input-group-addon custom-date-range-lable">'+s.label+"</span>",s.ranges)){var v="";$.each(s.ranges,function(t,e){m[e]&&(v+='<li><a href="#" class="dropdown-item list-group-item clickable" data-range="'+e+'">',v+=AppLanugage[e],v+="</a></li>")}),v&&(h=!0,f='<span class="input-group-addon custom-date-range-dropdown clickable">'+('<div class="dropdown"><div class="dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="true">'+s.label+'</div><div class="dropdown-menu"><ul class="list-group">'+v)+"</ul></div></div></span>")}var g="daterange-"+getRandomAlphabet(5),b='<div class="filter-item-box"><div class="input-daterange input-group '+g+'"><button class="btn btn-default form-control" name="'+r.name+'" data-date="'+r.value+'">'+c+"</button>"+f+'<button class="btn btn-default form-control" name="'+o.name+'" data-date="'+o.value+'">'+p+"</div></div>";t?a.appendFilterDom(b,!0):a.appendFilterDom(b);var y=i.find("."+g),k=y.find("button").toArray(),D=function(){var t=e.filterParams[r.name],a=e.filterParams[o.name];$(k[0]).html(t?moment(t,e._inputDateFormat).format("Do MMMM YYYY"):d),$(k[1]).html(a?moment(a,e._inputDateFormat).format("Do MMMM YYYY"):d)};y.datepicker({format:"yyyy-mm-dd",autoclose:!0,todayHighlight:!0,language:"custom",weekStart:AppHelper.settings.firstDayOfWeek,orientation:"bottom",inputs:k}).on("changeDate",function(t){var a=moment(t.date,e._inputDateFormat).customFormat(e._inputDateFormat);e.filterParams[r.name]||(e.filterParams[r.name]=a),e.filterParams[o.name]||(e.filterParams[o.name]=a),u($(t.target).attr("name"),a),D()}).on("show",function(){l&&($(".datepicker-clear-selection").show(),$(".datepicker-clear-selection").length||($(".datepicker").append("<div class='datepicker-clear-selection p5 clickable text-center'>"+AppLanugage.clear+"</div>"),$(".datepicker .datepicker-clear-selection").click(function(){e.filterParams[r.name]="",u(o.name,""),$(k[0]).html(d),$(k[1]).html(d),$(".datepicker").hide()})))}),h&&a.$instanceWrapper.find("."+g).on("click",".list-group-item",function(){var t=m[($(this).data()||{}).range];e.filterParams[o.name]=t[1],u(r.name,t[0]),D()}),a.filterElements[r.name]={setValue:function(t){e.filterParams[r.name]=t,y.datepicker("update",t),D()}},a.filterElements[o.name]={setValue:function(t){e.filterParams[o.name]=t,y.datepicker("update",t),D()}}})}prepareSingleDatePicker(){var t=this.settings,e=this,a=(this.$instance,this.$instanceWrapper);void 0!==t.singleDatepicker[0]&&$.each(t.singleDatepicker,function(i,n){var s=" ",r="",o="";n.options||(n.options=[]),n.options.push({value:"show-date-picker",text:AppLanugage.custom}),$.each(n.options,function(t,e){var a="";e.isSelected&&(a="active",r=e.value,o=e.text),s+='<div class="list-group-item '+a+'" data-value="'+e.value+'">'+e.text+"</div>"}),o||(s='<div class="list-group-item active" data-value="">'+(o="- "+n.defaultText+" -")+"</div>"+s),n.name&&(t.filterParams[n.name]=r);var l=function(a){t.filterParams[n.name]=a,e.reloadInstance()},d=function(t){return t+"<span class='ml10 dropdown-toggle'></span>"},c='<div class="datepicker-custom-list list-group mb0">'+s+"</div>",p="";n.class&&(p=n.class);var u='<div class="filter-item-box"><button name="'+n.name+'" class="btn '+p+' datepicker-custom-selector">'+d(o)+"</button></div>";e.appendFilterDom(u);var m=a.find("[name='"+n.name+"']"),f=void 0!==n.options[1];m.datepicker({format:t._inputDateFormat,autoclose:!0,todayHighlight:!0,language:"custom",weekStart:AppHelper.settings.firstDayOfWeek,orientation:"bottom"}).on("show",function(){f&&($(".datepicker-days, .datepicker-months, .datepicker-years, .datepicker-decades, .table-condensed").hide(),$(".datepicker-custom-list").show(),$(".datepicker-custom-list").length||($(".datepicker").append(c),$(".datepicker .list-group-item").click(function(){$(".datepicker .list-group-item").removeClass("active"),$(this).addClass("active");var e=$(this).attr("data-value");"show-date-picker"===e?($(".datepicker-custom-list, .datepicker-months, .datepicker-years, .datepicker-decades, .table-condensed").hide(),$(".datepicker-days, .table-condensed").show()):($(".datepicker").hide(),moment(e,t._inputDateFormat).isValid()&&(e=moment(e,t._inputDateFormat).customFormat(t._inputDateFormat)),m.html(d($(this).html())),l(e))})))}).on("changeDate",function(e){m.html(d(moment(e.date,t._inputDateFormat).format("Do MMMM YYYY"))),l(moment(e.date,t._inputDateFormat).customFormat(t._inputDateFormat))}),e.filterElements[n.name]={setValue:function(e){m.datepicker("update",e);var a="";$.each(n.options,function(t,i){e===i.value&&(a=i.text)}),e&&a?m.html(d(a)):e?m.html(d(moment(e,t._inputDateFormat).format("Do MMMM YYYY"))):n.defaultText&&m.html(d(n.defaultText)),$(".datepicker .list-group-item").removeClass("active"),$(".datepicker .list-group-item").each(function(){e===$(this).attr("data-value")&&$(this).addClass("active")})}}})}prepareRadioFilter(t=null){var e=this.settings,a=this,i=(this.$instance,this.$instanceWrapper);if(void 0!==e.radioButtons[0]||t){t&&(e.radioButtons=t.rangeOptions);var n="",s="",r="";$.each(e.radioButtons,function(t,a){var i="",o="";s=a.name,a.isChecked&&(i=" checked",o=" active",e.filterParams[a.name]=a.value,r=a.value),n+='<label class="btn btn-default mb0 '+o+'">',n+='<input type="radio" name="'+a.name+'" value="'+a.value+'" autocomplete="off" '+i+">"+a.text,n+="</label>"});var o="";t&&(o="range-radio-button");var l='<div class="filter-item-box '+o+'"><div class="btn-group filter" data-act="radio" data-toggle="buttons">'+n+"</div></div>";a.appendFilterDom(l);var d=i.find("[data-act='radio'] input[type=radio]");t&&t.onInit&&t.onInit(r),d.click(function(){setTimeout(function(){var i="";d.each(function(){$(this).closest("label").removeClass("active"),$(this).is(":checked")&&(e.filterParams[$(this).attr("name")]=$(this).val(),i=$(this).val(),$(this).closest("label").addClass("active"))}),t&&t.onChange&&t.onChange(i),a.reloadInstance()})}),a.filterElements[s]={setValue:function(i){d.each(function(){$(this).closest("label").removeClass("active"),$(this).val()==i?($(this).closest("label").addClass("active"),$(this).prop("checked",!0)):$(this).prop("checked",!1)}),t&&(t.onInit(i),s&&"dynamic"==e.filterParams[s]&&e.filterParams[s+"_dynamic"]&&a.filterElements[s+"_dynamic"]&&a.filterElements[s+"_dynamic"].setValue(e.filterParams[s+"_dynamic"]))}}}}prepareMultiselectFilter(){var t=this.settings,e=this,a=(this.$instance,this.$instanceWrapper);void 0!==t.multiSelect[0]&&$.each(t.multiSelect,function(i,n){var s="",r=[],o=n.saveSelection,l=getCookie(n.name);l&&(l=l.split("-")),$.each(n.options,function(t,e){var a="";(o&&l&&l.indexOf(e.value)>-1||o&&!l&&e.isChecked||!o&&e.isChecked)&&(a=" active",r.push(e.value)),s+='<li class="list-group-item clickable '+a+'" data-name="'+n.name+'" data-value="'+e.value+'">',s+=e.text,s+="</li>"}),s="<div class='dropdown-menu'><ul class='list-group' data-act='multiselect'>"+s+"</ul></div>";var d="";n.class&&(d=n.class),t.filterParams[n.name]=r;var c='<div class="filter-item-box"><span class="dropdown inline-block filter-multi-select"><button class="'+d+' btn btn-default dropdown-toggle caret " type="button" data-bs-toggle="dropdown" aria-expanded="true">'+n.text+" </button>"+s+"</span></div>";e.appendFilterDom(c);var p=a.find("[data-name='"+n.name+"']");p.click(function(){var a=$(this);return a.toggleClass("active"),setTimeout(function(){var i=[],s="";a.parent().find("li").each(function(){s=$(this).attr("data-name"),$(this).hasClass("active")&&i.push($(this).attr("data-value"))}),o&&(l=i.join("-"),setCookie(n.name,l)),t.filterParams[s]=i,e.reloadInstance()}),!1}),e.filterElements[n.name]={setValue:function(t){t||(t=[]),p.each(function(){t.includes($(this).attr("data-value"))?$(this).addClass("active"):$(this).removeClass("active")})}}})}prepareCheckboxFilter(){var t=this.settings,e=this,a=(this.$instance,this.$instanceWrapper);if(void 0!==t.checkBoxes[0]){var i="",n=[],s="";$.each(t.checkBoxes,function(t,e){var a="",r="";s=e.name,e.isChecked&&(a=" checked",r=" active",n.push(e.value)),i+='<label class="btn btn-default mb0 '+r+'">',i+='<input type="checkbox" name="'+e.name+'" value="'+e.value+'" autocomplete="off" '+a+">"+e.text,i+="</label>"}),t.filterParams[s]=n;var r='<div class="filter-item-box"><div class="btn-group filter" data-act="checkbox" data-toggle="buttons">'+i+"</div></div>";e.appendFilterDom(r),a.find("[data-act='checkbox']").click(function(){var a=$(this);setTimeout(function(){var i=[],n="";a.parent().find("input:checkbox").each(function(){n=$(this).attr("name"),$(this).is(":checked")?(i.push($(this).val()),$(this).closest("label").addClass("active")):$(this).closest("label").removeClass("active")}),t.filterParams[n]=i,e.reloadInstance()})}),e.filterElements[s]={setValue:function(t){t||(t=[]),a.find("input:checkbox").each(function(){s===$(this).attr("name")&&(t.includes($(this).val())?$(this).closest("label").addClass("active"):$(this).closest("label").removeClass("active"))})}}}}prepareDependentFilter(t,e,a,i,n){var s=this.$instanceWrapper;$.each(a,function(a,r){if(r.dependency&&r.dependency.length&&-1!==r.dependency.indexOf(t)){var o=s.find("select[name="+r.name+"]"),l=r.name;if((r.selfDependency&&!e||e)&&r.dataSource)appAjaxRequest({url:r.dataSource,data:i,type:"POST",dataType:"json",success:function(t){if(t&&t.length){var e="",a="";$.each(t,function(t,i){t||(a=i.id),e+="<option value='"+i.id+"'>"+i.text+"</option>"}),o.html(e),n&&n[l]?o.select2("val",n[l]):o.select2("val",a)}}});else{var d=o.find("option:first");o.html("<option value='"+d.val()+"'>"+d.html()+"</option>"),o.select2("val",d.val())}if(i&&n&&n[l])i[l]=n[l];else if(i){var d=o.find("option:first");i[r.name]=d.val()}}})}initDynamicFilter(t,e,a=!1){var i=this.settings,n=this.$instanceWrapper.find(".range-radio-button");if(n.nextAll(".filter-item-box").find('[data-act="datepicker"]').closest(".filter-item-box").remove(),n.nextAll(".filter-item-box").find(".input-daterange").closest(".filter-item-box").remove(),n.nextAll(".filter-item-box").find("#dynamic-range-dropdown").closest(".filter-item-box").remove(),"monthly"===e){if(i.dateRangeType="monthly",a||!i.filterParams.start_date){var s=moment().daysInMonth(),r=moment().customFormat("YYYY-MM");i.filterParams.start_date=r+"-01",i.filterParams.end_date=r+"-"+s}this.prepareDateRangePicker(!0)}else if("yearly"===e){if(i.dateRangeType="yearly",a){var o=moment().customFormat("YYYY");i.filterParams.start_date=o+"-01-01",i.filterParams.end_date=o+"-12-31"}this.prepareDateRangePicker(!0)}else if("custom"===e){var l=[{startDate:{name:"start_date",value:a?i.filterParams.start_date:moment().customFormat("YYYY-MM-DD")},endDate:{name:"end_date",value:a?i.filterParams.end_date:moment().customFormat("YYYY-MM-DD")},showClearButton:!0}];i.rangeDatepicker=l,this.prepareDatePickerFilter(!0)}else if("dynamic"===e){var d=t.find(function(t){return"dynamic"===t.value}),c=d.name+"_dynamic";if(i.selectedDynamicRange=i.filterParams[c],i.dynamicRanges=d.dynamicRanges,i.dynamicRangeFilterName=c,this.prepareDynamicFilterDomAndEvents(),a){var p=this.filterElements[c];p&&(!i.dynamicRanges||i.selectedDynamicRange&&i.dynamicRanges.includes(i.selectedDynamicRange)||(i.selectedDynamicRange=i.dynamicRanges[0]),p.setValue(i.selectedDynamicRange))}}setTimeout(function(){feather.replace()},1)}prepareRangeRadioButtons(){var t=this.settings,e=this;if(t.rangeRadioButtons&&void 0!==t.rangeRadioButtons[0]){var a={},i=[];$.each(t.rangeRadioButtons,function(t,e){$.each(e.options,function(t,a){i.push({text:AppLanugage[a],name:e.name,value:a,isChecked:a===e.selectedOption,dynamicRanges:e.dynamicRanges,selectedDynamicRange:e.selectedDynamicRange})}),a.rangeOptions=i}),a.onInit=function(t){e.initDynamicFilter(i,t)},a.onChange=function(t){e.initDynamicFilter(i,t,!0)},e.prepareRadioFilter(a)}}prepareDynamicFilterDomAndEvents(){var t=this.settings,e=this,a=(this.$instance,this.$instanceWrapper);if(void 0!==t.dynamicRanges&&t.dynamicRanges.length>0){var i=e.getDynamicDateRanges(),n='<div class="filter-item-box"><div class="btn-group">';t.selectedDynamicRange&&t.dynamicRanges&&!t.dynamicRanges.includes(t.selectedDynamicRange)&&(t.selectedDynamicRange=t.dynamicRanges[0]);var s="dynamic-range-dropdown";n+='<div class="dropdown dynamic-range-filter"><button class="btn btn-default dropdown-toggle caret" type="button" id="'+s+'" data-bs-toggle="dropdown">'+AppLanugage[t.selectedDynamicRange]+'</button><div class="dropdown-menu"><ul class="list-group">',$.each(t.dynamicRanges,function(e,a){var i="";a==t.selectedDynamicRange&&(i=" active "),n+='<li class="list-group-item clickable'+i+'" data-range="'+a+'">'+AppLanugage[a]+"</li>"}),n+="</ul></div></div>",n+="</div></div>",e.appendFilterDom(n,!0);var r=t.dynamicRangeFilterName,o=a.find("#"+s),l=function(e){i&&i[e]&&(t.filterParams.start_date=i[e][0],t.filterParams.end_date=i[e][1],t.filterParams[r]=e),o.html(AppLanugage[e]),o.closest(".dropdown").find(".list-group-item.active").removeClass("active"),o.closest(".dropdown").find('.list-group-item[data-range="'+e+'"]').addClass("active")};e.filterElements[r]={setValue:function(t){t&&l(t)}},o.closest(".dropdown").find(".dropdown-menu .list-group-item").on("click",function(){var t=$(this).data("range");t&&(l(t),e.reloadInstance())})}}}var buildFilterDom=function(t,e,a){new BuildFilters(t,e,a).init()};"undefined"!=typeof TableTools&&(TableTools.DEFAULTS.sSwfPath=AppHelper.assetsDirectory+"js/datatable/TableTools/swf/copy_csv_xls_pdf.swf");var $appFilterXhrRequest="new";function encodeAjaxPostData(t){return t=replaceAll("background-image","00bg-img00",t),t=replaceAll("&quot;","00quotation00",t),t=replaceAll("=","00~00",t),t=replaceAll("&","00^00",t)}function replaceAll(t,e,a){return a.replace(RegExp(t,"g"),e)}!function(t){t.fn.appTable=function(e){var a=1*AppHelper.settings.displayLength;(isNaN(a)||!a)&&(a=10);var i=!1;"1"===AppHelper.settings.disableResponsiveDataTable?i=!1:"1"!==AppHelper.settings.disableResponsiveDataTableForMobile&&window.outerWidth<800&&(i=!0);var n={source:"",columns:[],order:[[0,"asc"]],serverSide:!1,xlsColumns:[],printColumns:[],pdfColumns:[],hideTools:!1,columnShowHideOption:!0,tableRefreshButton:!1,displayLength:a,filterParams:{datatable:!0},smartFilterIdentity:null,ignoreSavedFilter:!1,dateRangeType:"",checkBoxes:[],multiSelect:[],radioButtons:[],filterDropdown:[],singleDatepicker:[],rangeDatepicker:[],rangeRadioButtons:[],isMobile:window.matchMedia("(max-width: 800px)").matches,responsive:i,stateSave:!0,stateDuration:5184e3,summation:"",onDeleteSuccess:function(){},onUndoSuccess:function(){},onInitComplete:function(){},footerCallback:function(t,e,a,i,n){},rowCallback:function(t,e,a,i){},onRelaodCallback:function(){},reloadHooks:[],customLanguage:{noRecordFoundText:AppLanugage.noRecordFound,searchPlaceholder:AppLanugage.search,printButtonText:AppLanugage.print,excelButtonText:AppLanugage.excel,printButtonToolTip:AppLanugage.printButtonTooltip,today:AppLanugage.today,yesterday:AppLanugage.yesterday,tomorrow:AppLanugage.tomorrow}},s=t(this);if(!s.is("table"))return console.log("appTable: Element must have to be a table",this),!1;s.on("length.dt page.dt order.dt search.dt",function(){setTimeout(function(){feather.replace()},1)});var r=t.extend({},n,e),o=t(this).attr("id");if(r.reload){var l=t(this).dataTable(),d={};window.InstanceCollection&&(d=window.InstanceCollection[o]),d||(d=r);var c=l.get(0).id;return d.serverSide?window.appTables[c]._fnReDraw():l&&l.fnReloadAjax&&l.fnReloadAjax(d.filterParams),t(this).data("onRelaodCallback")&&t(this).data("onRelaodCallback")(l,d.filterParams),t("#"+l.attr("id")).trigger("reset-selection-menu"),!1}if(r.newData){var l=t(this).dataTable();if(r.dataId){var p=t(this).find("[data-post-id='"+r.dataId+"']");p.length||(p=t(this).find("[data-index-id='"+r.dataId+"']")),p.length?(l.api().row(l.api().row(p.closest("tr")).index()).data(r.newData),l.fnUpdateRow(null,l.api().page())):l.fnUpdateRow(r.newData)}else r.rowDeleted?l.fnUpdateRow(r.newData,l.api().page(),!0):l.fnUpdateRow(r.newData);return!1}var u=function(e,a){var i={};i.id=a,i.server_side=0,appAjaxRequest({url:e.source,type:"POST",dataType:"json",data:i,success:function(e){e.data&&e.data[0]&&t("#"+o).appTable({newData:e.data[0],dataId:a})}})};t.each(r.reloadHooks||[],function(t,e){"app_form"===e.type&&e.id?registerAppFormHook(e.id,function(t,a){if(e.filter&&(i=t,!Object.entries(n=e.filter).every(([t,e])=>i[t]===e)))return"continue";t||(t={});var i,n,s=t[e.mapPostData&&e.mapPostData.id?e.mapPostData.id:"id"];!s&&a.id&&(s=a.id),u(r,s)},"appTable",o):"ajax_request"===e.type&&e.group?registerAjaxRequestHook(e.group,function(t){t||(t={});var a=t[e.mapPostData&&e.mapPostData.id?e.mapPostData.id:"id"];if(!a)return console.log("The id data is missing on the ajaxRequestData"),!1;u(r,a)},"appTable",o):"app_modifier"===e.type&&e.group?registerAppModifierHook(e.group,function(t,a){t||(t={});var i=t[e.mapPostData&&e.mapPostData.id?e.mapPostData.id:"id"];if(!i)return console.log("The id data is missing on the appModifierData"),!1;u(r,i)},"appTable",o):"app_table_row_update"===e.type&&e.tableId&&registerAppTableRowUpdateHook(e.tableId,function(t){t||(t={});var a=t[e.mapPostData&&e.mapPostData.id?e.mapPostData.id:"id"];if(!a)return console.log("The id data is missing on the appTableRowUpdateData"),!1;u(r,a)},"appTable",o)}),r.responsive&&s.addClass("nowrap");var m=function(e,a,i){var n="",s="";return"all"===a&&(s='data-section="all_pages"'),n+="<tr "+s+">",t.each(e.columns,function(s,r){var o="class = 'tf-blank' ",l=" ";e.summation[0]&&e.summation[0].column-1===s&&(l=i,o="class = 'tf-lable' "),t.each(e.summation,function(t,e){e.column===s&&(o="class = 'tf-result text-right' ",o+="data-"+a+'-page="'+e.column+'"')}),n+="<th "+o+">",n+=l,n+="</th>"}),n+="</tr>"};if(r.summation&&r.summation.length&&!r.isMobile){var f="<tfoot>";f+=m(r,"current",AppLanugage.total),f+=m(r,"all",AppLanugage.totalOfAllPages),f+="</tfoot>",s.html(f)}r._visible_columns=[];var h=!1;r.columns.find(t=>t.class&&t.class.includes("all"))&&(h=!0),t.each(r.columns,function(t,e){!1!==e.visible&&r._visible_columns.push(t);var a=!1;r.serverSide?e.order_by?a=!0:!e.order_by&&e.iDataSort&&r.columns[e.iDataSort].order_by&&(a=!0):!1!==e.sortable&&(a=!0),r.columns[t].orderable=a,h&&r.isMobile&&(e.class&&!e.class.includes("all")||!e.class)&&(r.columns[t].class=r.columns[t].class?r.columns[t].class+" desktop":"desktop"),r.isMobile||!r.mobileMirror||(!e.class||e.class.includes("all"))&&e.class||(r.columns[t].class=r.columns[t].class?r.columns[t].class+" mobile-only":"mobile-only")}),r._exportable=r.xlsColumns.length+r.pdfColumns.length+r.printColumns.length,r._firstDayOfWeek=AppHelper.settings.firstDayOfWeek||0,r._inputDateFormat="YYYY-MM-DD",r=prepareDefaultFilters(r);var v=[[10,25,50,100,-1],[10,25,50,100,AppLanugage.all]];if(r.serverSide){var g=[10,25,50,100];window.addAppTableDisplayOption&&Number(window.addAppTableDisplayOption)>0&&g.push(Number(window.addAppTableDisplayOption)),v=[g,g]}var i=r.responsive,b=cloneDeep(r.stateSave),a=cloneDeep(r.displayLength);!r.isMobile&&r.mobileMirror&&(i={breakpoints:[{name:"all",width:1/0},{name:"mobile-only",width:480}]},b=!1,a=25);var y={ajax:{url:r.source,type:"POST",data:function(e){var a=e.order&&e.order[0]?e.order[0].column:"",i=e.order&&e.order[0]?e.order[0].dir:"",n=e.search?e.search.value:"";i&&(i=i.toUpperCase());var s=0;return r.serverSide&&(s=1),t.extend({order_by:r.columns[a]?r.columns[a].order_by:"",order_dir:i,search_by:n,skip:e.start,limit:e.length,draw:e.draw,server_side:s},r.filterParams)},error:function(t,e,a){appAlert.error(AppLanugage.somethingWentWrong)},dataSrc:function(t){return r.summationInfo=t.summation,t.data}},sServerMethod:"POST",columns:r.columns,bProcessing:!0,serverSide:r.serverSide,iDisplayLength:a,aLengthMenu:v,bAutoWidth:!1,bSortClasses:!1,order:r.order,stateSave:b,responsive:i,fnStateLoadParams:function(t,e){e&&e.search&&(e.search.search="")},stateDuration:r.stateDuration,fnInitComplete:function(){r.onInitComplete(this)},language:{lengthMenu:"_MENU_",zeroRecords:r.customLanguage.noRecordFoundText,info:"_START_-_END_ / _TOTAL_",sInfo:"_START_-_END_ / _TOTAL_",infoFiltered:"(_MAX_)",search:"",searchPlaceholder:r.customLanguage.searchPlaceholder,sInfoEmpty:"0-0 / 0",sInfoFiltered:"(_MAX_)",sInfoPostFix:"",sInfoThousands:",",sProcessing:"<div class='table-loader'><span class='loading'></span></div>",oPaginate:{sPrevious:"<i data-feather='chevron-left' class='icon-16'></i>",sNext:"<i data-feather='chevron-right' class='icon-16'></i>"}},sDom:"",footerCallback:function(e,a,i,n,s){var o=this;if(r.summation){var d=o.api().page.info(),c="",p="",u="";if(!d.recordsTotal)return t(o).find("tfoot").hide(),!1;t(o).find("tfoot").show(),t.each(r.summation,function(e,a){var i=calculateDatatableTotal(o,a.column,function(t){return!t||t.startsWith("<b>")?0:"currency"===a.dataType?(a.dynamicSymbol&&(a.currencySymbol=t.replace(/[0-9.,-]/g,"")),unformatCurrency(t,a.conversionRate)):"time"===a.dataType?moment.duration(t).asSeconds():"number"===a.dataType?unformatCurrency(t):t},!0);"currency"===a.dataType?i=toCurrency(i,a.currencySymbol):"time"===a.dataType?i=secondsToTimeFormat(i):"number"===a.dataType&&(i=toCurrency(i,"none"));var n=l.column(a.column).header();if(n&&(p+="<div class='box'><div class='box-content'>"+t(n).html()+"</div><div class='box-content text-right'>"+i+"</div></div>"),t(o).find("[data-current-page="+a.column+"]").html(i),d.pages>1){t(o).find("[data-section='all_pages']").show();var s=0;if(r.serverSide){var c=r.summationInfo;c&&a.fieldName&&(s=c[a.fieldName]?c[a.fieldName]:0)}else s=calculateDatatableTotal(o,a.column,function(t){return!t||t.startsWith("<b>")?0:"currency"===a.dataType?unformatCurrency(t,a.conversionRate):"time"===a.dataType?moment.duration(t).asSeconds():"number"===a.dataType?unformatCurrency(t):t});"currency"===a.dataType?s=toCurrency(s,a.currencySymbol):"time"===a.dataType?s=secondsToTimeFormat(s):"number"===a.dataType&&(s=toCurrency(s,"none"));var m=l.column(a.column).header();m&&(u+="<div class='box'><div class='box-content'>"+t(m).html()+"</div><div class='box-content text-right'>"+s+"</div></div>"),t(o).find("[data-all-page="+a.column+"]").html(s)}else t(o).find("[data-section='all_pages']").hide()}),(r.isMobile||r.mobileMirror)&&(p&&(c+="<div class='box'><div class='box-content strong'>"+AppLanugage.total+"</div></div>"+p),u&&(c+="<div class='box'><div class='box-content strong'>"+AppLanugage.totalOfAllPages+"</div></div>"+u),t(".summation-section").html(c))}r.footerCallback(e,a,i,n,s,o)},fnRowCallback:function(t,e,a,i){r.rowCallback(t,e,a,i)},preDrawCallback:function(e){e.aoData.length>0?t(".summation-section").removeClass("hide"):t(".summation-section").addClass("hide")}};AppHelper.userId&&(y.stateSaveParams=function(t,e){-1===t.sInstance.indexOf("-user-ref-")&&(t.sInstance+="-user-ref-"+AppHelper.userId)},y.stateLoadCallback=function(t){-1===t.sInstance.indexOf("-user-ref-")&&(t.sInstance+="-user-ref-"+AppHelper.userId);try{var e=location.pathname;return r.mobileMirror&&(e=e.replace(/\/compact_view\/.*/,"")),JSON.parse((-1===t.iStateDuration?sessionStorage:localStorage).getItem("DataTables_"+t.sInstance+"_"+e))}catch(a){}});var k="";if(r._exportable){var D=[];r.xlsColumns.length&&D.push({extend:"excelHtml5",footer:!0,text:r.customLanguage.excelButtonText,exportOptions:{columns:r.xlsColumns},customize:function(e){if(s.find("[data-section='all_pages']")&&"none"!==s.find("[data-section='all_pages']").css("display")){var a=e.xl.worksheets["sheet1.xml"],i=t(a.childNodes[0].childNodes[1]),n=parseInt(i.find("row:last-child").attr("r"))+1,r=0,o='<row r="'+n+'">';s.find("[data-section='all_pages'] th").each(function(){t(this).text()&&(o+='<c t="inlineStr" r="'+"abcdefghijklmnopqrstuvwxyz"[r].toUpperCase()+n+'" s="2">',o+="<is>",o+="<t>"+t(this).text()+"</t>",o+="</is>",o+="</c>"),r+=1}),o+="</row>",a.childNodes[0].childNodes[1].innerHTML=a.childNodes[0].childNodes[1].innerHTML+o}}}),r.pdfColumns.length&&D.push({extend:"pdfHtml5",exportOptions:{columns:":visible:not(.option)"}}),r.printColumns.length&&D.push({extend:"print",autoPrint:!1,text:r.customLanguage.printButtonText,footer:!0,exportOptions:{columns:r.printColumns},customize:function(e){if(t(e.document.body).closest("html").addClass("dt-print-view"),s.find("[data-section='all_pages']")&&"none"!==s.find("[data-section='all_pages']").css("display")){var a=s.find("[data-section='all_pages']").clone();t(e.document.body).find("tfoot").append(a)}},customizeData:function(t,e,a){}}),y.buttons=D,k="<'datatable-export filter-item-box'B >"}var x="";r.smartFilterIdentity&&(x="<'filter-form'>");var w="",C="col-md-3",F="col-md-9";(r.isMobile||r.mobileMirror)&&(w=k,k="",C="col-md-12",F="col-md-12 mini-list-pagination-container"),r.hideTools||(y.sDom="<'filter-section-container' <'filter-section-flex-row' <'filter-section-left'> <'filter-section-right' "+k+" <'filter-item-box' f> > > "+x+" r>t<'datatable-tools clearfix row'<'"+C+" pl15'<'summation-section'> <'table-bottom-left' li ><'float-end'"+w+">><'"+F+" pr15'p>>"),y.drawCallback=function(){if(r.serverSide){var t=s.closest(".dataTables_wrapper").find("input[type=search]");!t.val()&&r.filterParams&&r.filterParams.search_by&&t.val(r.filterParams&&r.filterParams.search_by)}};var Y=s.dataTable(y),M=s.closest(".dataTables_wrapper"),c=s.get(0)?s.get(0).id:"id_not_found";if(window.appTables||(window.appTables=[]),window.appTables[c]=Y,M.find("select").select2({minimumResultsForSearch:-1}),r.columnShowHideOption){var c=s.attr("id");l=s.DataTable(),r.isMobile||r.mobileMirror||M.find(".filter-section-left").append('<div class="filter-item-box"><button class="btn btn-default column-show-hide-popover" data-container="body" data-bs-toggle="popover" data-placement="bottom"><i data-feather="columns" class="icon-16"></i></button></div>'),M.find(".column-show-hide-popover").popover({html:!0,sanitize:!1,content:function(){var e="";return t.each(r.columns,function(t,a){if(!1!==a.visible){var i=l.column(t),n="",s="";i.visible()||(n="active",s="<i data-feather='eye-off' class='icon-16 mr10'></i>"),e+="<li class='"+n+" list-group-item clickable toggle-table-column' data-column='"+t+"'>"+s+a.title+"</li>"}}),"<ul class='list-group' data-table='"+c+"'>"+e+"</ul>"}}),M.find(".column-show-hide-popover").on("shown.bs.popover",function(){feather.replace(),t(".toggle-table-column").on("click",function(){var e=t(this).closest(".list-group").attr("data-table"),a=t("#"+e).DataTable().column(t(this).attr("data-column"));a&&(a.visible(!a.visible()),t(this).toggleClass("active"))})})}(r.tableRefreshButton&&(M.find(".filter-section-left").append('<div class="filter-item-box float-start "><button class="btn btn-default at-table-refresh-button ml15"><i data-feather="refresh-cw" class="icon-16"></i></button></div>'),M.find(".at-table-refresh-button").on("click",function(){s.appTable({reload:!0,filterParams:r.filterParams})})),t("body").hasClass("destroy-popover")||(t("body").addClass("destroy-popover"),t(".destroy-popover").on("click",function(e){if("popover"!==t(e.target).closest("button").attr("data-bs-toggle")&&!t(e.target).closest(".popover").length&&!t(e.target).hasClass("editable")){var a=t(".popover.in").attr("id");t("[aria-describedby="+a+"]").trigger("click")}})),s.data("onRelaodCallback",r.onRelaodCallback),r.serverSide)?(M.find("input[type=search]").unbind().bind("input",delayAction(function(e){r.filterParams.search_by=t(this).val(),s.appTable({reload:!0,filterParams:r.filterParams})},1e3)),t("body").on("click","#"+s.get(0).id+" .badge.clickable",function(){return!t(this).closest(".js-selection-mode").length&&(r.filterParams.search_by=t(this).text(),s.appTable({reload:!0,filterParams:r.filterParams}),!1)}),t("body").on("click","#"+s.get(0).id+" .filter-sub-task-button",function(){return r.filterParams.search_by=t(this).attr("main-task-id"),s.appTable({reload:!0,filterParams:r.filterParams}),!1}),t("body").on("click","#"+s.get(0).id+" .remove-filter-button",function(){return r.filterParams.search_by="",s.appTable({reload:!0,filterParams:r.filterParams}),!1})):t("body").on("click","#"+s.get(0).id+" .badge.clickable",function(){var e=t(this).text();return t(this).closest(".dataTable").DataTable().search(e).draw(),t(this).closest(".dataTables_wrapper").find("input[type=search]").val(e).focus().select(),!1}),buildFilterDom(r,M,s);var _=function(e){t('<a class="undo-delete" href="javascript:;"><strong>'+AppLanugage.undo+"</strong></a>").insertAfter(t(e.alertSelector).find(".app-alert-message")),t(e.alertSelector).find(".undo-delete").bind("click",function(){t(e.alertSelector).remove(),appLoader.show(),appAjaxRequest({url:e.url,type:"POST",dataType:"json",data:{id:e.id,undo:!0},success:function(t){if(appLoader.hide(),t.success){s.appTable({newData:t.data,rowDeleted:!0}),r.onUndoSuccess(t);var a=s.attr("id");a&&window.appTableRowDeleteHook&&window.appTableRowDeleteHook[a]&&window.appTableRowDeleteHook[a].forEach(function(t){"function"==typeof t.onSuccess&&t.onSuccess({id:e.id})})}}})})},P=function(t,e){var a=e.closest("tr"),i=s.DataTable(),n=e.attr("data-undo"),o=e.attr("data-action-url"),l=e.attr("data-id");a.hasClass("child")&&(a=a.prev(".parent")),Y.fnDeleteRow(i.row(a).index(),function(){i.page(i.page()).draw("page")},!1);var d=appAlert.warning(t.message,{duration:2e4});r.onDeleteSuccess(t),"0"!==n&&_({alertSelector:d,url:o,id:l})},S=function(t){deleteConfirmationHandler(t,P)},T=function(t){deleteHandler(t,P)},I=function(e){appLoader.show();var a=t(e.currentTarget);e.data&&e.data.target&&(a=e.data.target);var i=a.attr("data-action-url"),n=a.closest("table").attr("id");appAjaxRequest({url:i,dataType:"json",success:function(e){e.success?(e.data&&t("#"+n).appTable({newData:e.data,dataId:e.id}),appAlert.success(e.message,{duration:1e4}),n&&window.appTableRowUpdateHook&&window.appTableRowUpdateHook[n]&&window.appTableRowUpdateHook[n].forEach(function(t){"function"==typeof t.onSuccess&&t.onSuccess({id:e.id})})):appAlert.error(e.message),appLoader.hide()}})};window.InstanceCollection=window.InstanceCollection||{},window.InstanceCollection[t(this).attr("id")]=r,t("body").find(s).on("click","a[data-action=delete]",T),t("body").find(s).on("click","a[data-action=delete-confirmation]",S),t("body").find(s).on("click","[data-action=update]",I),t.fn.dataTableExt.oApi.getSettings=function(t){return t},t.fn.dataTableExt.oApi.fnReloadAjax=function(e,a){this.fnClearTable(this),this.oApi._fnProcessingDisplay(e,!0);var i=this;"new"===$appFilterXhrRequest&&($appFilterXhrRequest=t.ajax({url:e.ajax.url,type:"POST",dataType:"json",data:a,success:function(t){$appFilterXhrRequest="new";for(var a=0;a<t.data.length;a++)i.oApi._fnAddData(e,t.data[a]);e.aiDisplay=e.aiDisplayMaster.slice(),i.fnDraw(i),i.oApi._fnProcessingDisplay(e,!1)}}))},t.fn.dataTableExt.oApi.fnUpdateRow=function(t,e,a,i){e&&this.oApi._fnAddData(t,e),i&&this.fnDraw(this),a?this.oApi._fnPageChange(t,a,!0):this.fnDraw(this)}}}(jQuery),deleteHandler=function(t,e,a={}){appLoader.show();var i=$(t.currentTarget);t.data&&t.data.target&&(i=t.data.target);var n=i.attr("data-action-url"),s=i.attr("data-id"),r=i.attr("data-reload-on-success"),o=i.closest("table").attr("id");a||(a={}),a.id=s,appAjaxRequest({url:n,type:"POST",dataType:"json",data:a,success:function(t){t.success?(e&&e(t,i),r&&location.reload(),o&&window.appTableRowDeleteHook&&window.appTableRowDeleteHook[o]&&window.appTableRowDeleteHook[o].forEach(function(t){"function"==typeof t.onSuccess&&t.onSuccess({id:s})})):appAlert.error(t.message),appLoader.hide()}})},deleteConfirmationHandler=function(t,e){var a=$("#confirmDeleteButton"),i=$(t.currentTarget),n={};i.each(function(){$.each(this.attributes,function(){this.specified&&this.name.match("^data-")&&a.attr(this.name,this.value),this.specified&&this.name.match("^data-post-")&&(n[this.name.replace("data-post-","")]=this.value)})}),i.attr("data-undo","0"),a.unbind("click"),a.on("click",{target:i},function(t){deleteHandler(t,e,n)}),$("#confirmationModal").modal("show")},(define=function(t,e){window.appAlert=e(window.jQuery)})(["jquery"],function(t){return function(){var e={info:function t(e,n){return this._settings=a(n),this._settings.alertType="info",i(e),"#"+this._settings.alertId},success:function t(e,n){return this._settings=a(n),this._settings.alertType="success",i(e),"#"+this._settings.alertId},warning:function t(e,n){return this._settings=a(n),this._settings.alertType="warning",i(e),"#"+this._settings.alertId},error:function t(e,n){return this._settings=a(n),this._settings.alertType="error",i(e),"#"+this._settings.alertId},options:{container:"body",duration:0,showProgressBar:!0,clearAll:!0,animate:!0}};return e;function a(a){if(!a)var a={};return a.alertId="app-alert-"+function t(){for(var e="",a="abcdefghijklmnopqrstuvwxyz0123456789",i=0;i<5;i++)e+=a.charAt(Math.floor(Math.random()*a.length));return e}(),this._settings=t.extend({},e.options,a)}function i(e){(function e(){this._settings.clearAll&&t("[role='alert']").remove()})(),t(this._settings.container).length?(this._settings.animate&&setTimeout(function(){t(".app-alert").animate({opacity:1,right:"40px"},500,function(){t(".app-alert").animate({right:"15px"},300)})},20),t(this._settings.container).prepend(function t(e){var a="info";return"error"===this._settings.alertType?a="danger":"success"===this._settings.alertType?a="success":"warning"===this._settings.alertType&&(a="warning"),this._settings.animate&&(a+=" animate"),'<div id="'+this._settings.alertId+'" class="app-alert alert alert-'+a+' alert-dismissible " role="alert"><button type="button" class="btn-close btn-close-white" data-bs-dismiss="alert" aria-label="Close"></button><div class="app-alert-message">'+e+'</div><div class="progress"><div class="progress-bar bg-'+a+' hide" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 100%"></div></div></div>'}(e)),function e(){if(this._settings.duration&&this._settings.showProgressBar){var a="#"+this._settings.alertId,i=t(a).find(".progress-bar");i.removeClass("hide").width(0);var n="width "+this._settings.duration+"ms ease";i.css({WebkitTransition:n,MozTransition:n,MsTransition:n,OTransition:n,transition:n}),setTimeout(function(){t(a).length>0&&t(a).remove()},this._settings.duration)}}()):console.log("appAlert: container must be an html selector!")}}()}),(define=function(t,e){window.appLoader=e(window.jQuery)})(["jquery"],function(t){var e;return{show:function e(a){var i=t("#app-loader");if(this._settings=function e(a){if(!a)var a={};return this._settings=t.extend({},appLoader.options,a)}(a),!i.length){var n=t(this._settings.container);n.length?(this._settings.css||(this._settings.css="top:25%; right:"+Math.round(n.outerWidth()/2)+"px;"),n.append('<div id="app-loader" class="app-loader" style="z-index:'+this._settings.zIndex+";"+this._settings.css+'"><div class="loading"></div></div>')):console.log("appLoader: container must be an html selector!")}},hide:function e(){var a=t("#app-loader");a.length&&a.remove()},options:{container:"body",zIndex:"auto",css:""}}}),(define=function(t,e){window.appCompactView=e(window.jQuery)})(["jquery"],function(t){var e;return e={init:function a(i){i||(i={});var n=t.extend({},e.options,i);this._settings=n;var s=n.pageId;return t(s).append('<div id="'+n.compactDetailsPageIdName+'" class="w-100"></div>'),e._initListClickEvent(),!!n.compactViewId&&(window.compact_view_id=n.compactViewId,e.setActiveRow(),isMobile()&&(window.location.href=n.dataSourceUrl),t("."+n.pageWrapperClassName).removeClass(n.pageWrapperClassName),t("body").addClass("compact-view-active"),t(s+" div:first").addClass("mobile-mirror"),t(s+" div:first").addClass("compact-view-left-panel"),t(s).wrapInner('<div class="d-flex"></div>'),t(s).find("table.xs-hide-dtr-control").addClass("hide-dtr-control"),n.backButtonUrl&&t(s).find("ul.nav-tabs").prepend('<a class="back-btn dark" href="'+n.backButtonUrl+'"><i data-feather="arrow-left" class="icon-16"></i> '+n.backButtonText+"</a>"),t(s).find("ul.nav-tabs").append('<div id="mobile-function-button" class="more-options-btn"></div>'),t(".title-button-group").removeClass("skip-dropdown-migration"),convertTabButtonsToDropdownOnMobileView(".title-button-group",!0),appContentBuilder.init(n.dataSourceUrl,{data:n.appContentBuilderData,reloadHooks:n.appContentBuilderReloadHooks,reload:function(t,e){t("#"+n.compactDetailsPageIdName,e.content)}}).reload(),e)},setActiveRow:function e(){t(this._settings.pageId).find("[data-action=load_compact_view][data-compact_view_id="+window.compact_view_id+"]").closest("tr").addClass("active")},_initListClickEvent:function a(){var i=this._settings;if(!i.pageId)return!1;t(i.pageId).on("click","[data-action=load_compact_view]",function(){t(this).closest("td.all").length>0&&t(this).closest("td.all").trigger("click");var a=t(this),n=a.data()||{},s=t("#"+i.compactDetailsPageIdName);if(i.compactViewBaseUrl&&n.compact_view_id){var r={Url:i.compactViewBaseUrl+n.compact_view_id};history.pushState(r,"",r.Url),window.compact_view_id=n.compact_view_id,a.closest("table").find("tr.active").removeClass("active"),e.setActiveRow()}s.children().fadeOut(),isMobile()?a.closest("table").find("tr.active .mini-list-item .spinning-btn").addClass("spinning"):appLoader.show({container:s});var o={url:n.actionUrl,data:{view_type:"compact_view"},cache:!1,type:"POST",dataType:"json",success:function(t){isMobile()&&a.closest("table").find("tr.active .mini-list-item .spinning-btn").removeClass("spinning"),appLoader.hide(),s.html(t.content)},statusCode:{404:function(){appLoader.hide(),appAlert.error("404: Page not found.")}},error:function(){appLoader.hide(),appAlert.error(AppLanugage.somethingWentWrong)}};return t.ajax(o)})},_settings:{},options:{dataSourceUrl:"",backButtonUrl:"",backButtonText:"",compactViewBaseUrl:"",compactViewId:null,pageId:"#page-content",pageWrapperClassName:"page-wrapper",compactDetailsPageIdName:"compact-details-page",appContentBuilderData:{view_type:"compact_view"},appContentBuilderReloadHooks:[]}}}),(define=function(t,e){window.appContentBuilder=e(window.jQuery)})(["jquery"],function(t){return function(){return{id:null,ajaxConfig:{},reloadHooks:[],reloadCallback:null,init:function t(e,a){return this.ajaxConfig.url=e,this.ajaxConfig.data=a.data||{},this.reloadHooks=a.reloadHooks||[],this.reloadCallback=a.reload||null,this.id=a.id||getRandomAlphabet(5),this.attachHooks(),this},attachHooks:function e(){var a=this;window.LinkHooks||(window.LinkHooks={}),t.each(a.reloadHooks,function(t,e){"app_form"===e.type&&e.id?registerAppFormHook(e.id,function(){a.reload()},"appContentBuilder",a.id):"ajax_request"===e.type&&e.group?registerAjaxRequestHook(e.group,function(){a.reload()},"appContentBuilder",a.id):"app_modifier"===e.type&&e.group?registerAppModifierHook(e.group,function(){a.reload()},"appContentBuilder",a.id):"app_table_row_update"===e.type&&e.tableId?registerAppTableRowUpdateHook(e.tableId,function(){a.reload()},"appContentBuilder",a.id):"app_table_row_delete"===e.type&&e.tableId&&registerAppTableRowDeleteHook(e.tableId,function(){a.reload()},"appContentBuilder",a.id)})},reload:function t(){var a=this;appAjaxRequest({url:a.ajaxConfig.url,method:"POST",data:a.ajaxConfig.data,dataType:"json",success:function(t){"function"==typeof a.reloadCallback&&a.reloadCallback(e,t)},error:function(t,e,a){console.error("Error reloading appContentBuilder content:",a)}})}};function e(e,a){t(e).html(a)}}()}),(define=function(t,e){window.appContentModal=e(window.jQuery)})(["jquery"],function(t){return function(){var e={init:function s(r){var o,l,d,c,p,u,m;this._settings=(o=this,l=r,l||(l={}),t.extend({},o.options,l)),i(this._settings),c=(d=this._settings).modalId,p="<div class='app-modal-sidebar hidden-xs'>                                        <div class='app-modal-close'><span>&times;</span></div>                                        <div class='app-moadl-sidebar-scrollbar'>                                            <div class='app-modal-sidebar-area'>                                            </div>                                        </div>                                    </div>",u="<span class='expand round-button hidden-xs'><i data-feather='maximize-2' class='icon-16'></i></span>",(!1===d.sidebar||isMobile())&&(p="",u="<div class='app-modal-close app-modal-fixed-close-button'><span>&times;</span></div>"),u+="<span class='app-modal-zoom-in-button hide round-button clickable'><i data-feather='zoom-in' class='icon-18'></i></span>",u+="<span class='app-modal-zoom-out-button hide round-button clickable'><i data-feather='zoom-out' class='icon-18'></i></span>",u+="<span class='app-modal-previous-button hide round-button clickable'><i data-feather='chevron-left' class='icon-18'></i></span>",m="<div class='app-modal loading' id='"+c+"'>                                <span class='compress round-button'><i data-feather='minimize-2' class='icon-16'></i></span>                                <div class='app-modal-body'>                                    <div class='app-modal-content fit-window-height'>"+(u+="<span class='app-modal-next-button hide round-button clickable'><i data-feather='chevron-right' class='icon-18'></i></span>")+"<div class='hide app-modal-close'><span>&times;</span></div>                                        <div class='app-modal-content-area d-inline-block'>                                        </div>                        </div>"+p+"</div>                            </div>",t("body").addClass("app-modal-open").prepend(m),t("#"+c+" .expand").click(function(){t(".app-modal").addClass("full-content")}),t("#"+c+" .compress").click(function(){t(".app-modal").removeClass("full-content")}),t("#"+c+" .app-modal-close").click(function(){i(d)}),t(document).bind("keyup",{settings:d},a),t("#"+c+" .app-modal-sidebar").is(":visible")?appLoader.show({container:"#"+c,css:"top:35%; right:55%;"}):appLoader.show({container:"#"+c,css:"top:35%; right:48%;"}),d.url?appModalXhr=t.ajax({url:d.url||"",data:{},cache:!1,type:"POST",success:function(t){n(d,t)},statusCode:{404:function(){e.destroy(d),appAlert.error("404: Page not found.")}},error:function(){e.destroy(d),appAlert.error(AppLanugage.somethingWentWrong)}}):n(d)},destroy:i,_settings:{},options:{url:"",css:"",sidebar:!1,modalId:getRandomAlphabet(5)}};return e;function a(t){27===t.keyCode&&i(t.data.settings)}function i(e){var i=getRandomAlphabet(5);t("#"+e.modalId).attr("id",i).fadeOut(200),t("#"+i).length&&setTimeout(function(){t("#"+i).remove()},200),t(document).unbind("keyup",a),"undefined"!=typeof appModalXhr&&appModalXhr.abort(),t("body").removeClass("app-modal-open")}function n(e,a){var i=e.modalId,n=e.sourceElement.data(),s=t(window).height(),r=t(window).width();if(a){var o=t(a);t("#"+i+" .app-modal-content-area").html(o.find(".app-modal-content").html());var l=o.find(".app-modal-sidebar").html();t("#"+i+" .app-modal-sidebar-area").html(l),o.remove()}else if(n.content_url){var d="";"image"===n.type?d="<img id='img_"+i+"' src='"+n.content_url+"'>":"iframe"===n.type?d="<div style='background:#fff;'><iframe id='iframe-file-viewer' src='"+n.content_url+"' style='width:"+r+"px; margin:0; border:0; height:"+s+"px; '><div>":"txt"===n.type?(r>1300&&(r-=200),d="<div style='background:#fff;'><iframe id='iframe-file-viewer' src='"+n.content_url+"' style='width:"+r+"px; margin:0; border:0; height:"+s+"px; '><div>"):"audio"===n.type?d="<audio src='"+n.content_url+"' controls='' class='audio'></audio>":"not_viewable"===n.type&&(d="<div class='card'><div class='card-body'><h5 class='card-title'>"+n.description+"</h5><p class='card-text'>"+n.filename+"</p></div></div>"),t("#"+i+" .app-modal-content-area").html(d)}t("#"+i).removeClass("loading"),l?(t("#"+i).addClass("has-sidebar"),setTimeout(function(){t("#"+i+" #file-preview-comment-container").height()>t(window).height()-300&&initScrollbar("#"+i+" #file-preview-comment-container",{setHeight:t(window).height()-300})})):t("#"+i).removeClass("has-sidebar"),appLoader.hide();var c=t("[data-toggle='app-modal']"),p=null;n.target_group?c=t("[data-group='"+n.target_group+"']"):n.group&&(c=t("[data-group='"+n.group+"']")),n.preview_function&&(p=n.preview_function);var u=0,m=0,f=0;if(c.length>1){c.each(function(a){var i=t(this).data();i&&i.url&&i.url===e.url?f=a:i&&i.content_url&&i.content_url===e.content_url&&(f=a)}),u=c[f-1]?f-1:c.length-1,m=c[f+1]?f+1:0;var h=function(t,e){e?"function"==typeof window[e]?window[e](t):console.log("Undefined preview_function",e):t.trigger("click")};t("#"+i+" .app-modal-previous-button").click(function(){c.each(function(e){e===u&&h(t(this),p)})}),t("#"+i+" .app-modal-next-button").click(function(){c.each(function(e){e===m&&h(t(this),p)})}),feather.replace(),t("#"+i+" .app-modal-previous-button").removeClass("hide"),t("#"+i+" .app-modal-next-button").removeClass("hide")}t("#"+i+" .app-modal-zoom-in-button").click(function(){if(t(this).hasClass("disabled"))return!1;t("#"+i+" .app-modal-content-area").addClass("scrollable"),t("#"+i+" .app-modal-content").removeClass("fit-window-height"),t(this).addClass("disabled"),t("#"+i+" .app-modal-zoom-out-button").removeClass("disabled")}),t("#"+i+" .app-modal-zoom-out-button").click(function(){if(t(this).hasClass("disabled"))return!1;t("#"+i+" .app-modal-content-area").removeClass("scrollable"),t("#"+i+" .app-modal-content").addClass("fit-window-height"),t(this).addClass("disabled"),t("#"+i+" .app-modal-zoom-in-button").removeClass("disabled")});var v=document.getElementById("img_"+i);v&&v.addEventListener("load",function(){var e=t(window).height(),a=t("#"+i+" .app-modal-content-area").find("img");a&&a[0]&&a[0].naturalHeight>e&&(t("#"+i+" .app-modal-zoom-in-button").removeClass("hide"),t("#"+i+" .app-modal-zoom-out-button").removeClass("hide").addClass("disabled")),t.fn.mCustomScrollbar&&t("#"+i+" .app-moadl-sidebar-scrollbar").mCustomScrollbar({setHeight:e,theme:"minimal-dark",autoExpandScrollbar:!0})}),setTimeout(function(){var e=t(window).height(),a=t("#"+i+" .app-modal-content-area").find("img");a&&a[0]&&a[0].naturalHeight>e&&(t("#"+i+" .app-modal-zoom-in-button").removeClass("hide"),t("#"+i+" .app-modal-zoom-out-button").removeClass("hide").addClass("disabled")),t.fn.mCustomScrollbar&&t("#"+i+" .app-moadl-sidebar-scrollbar").mCustomScrollbar({setHeight:e,theme:"minimal-dark",autoExpandScrollbar:!0})},300)}}()}),function(t){t.fn.appDateRange=function(e){var a=t.extend({},{dateRangeType:"yearly",filterParams:{},onChange:function(t){},onInit:function(t){}},e);a._inputDateFormat="YYYY-MM-DD",this.each(function(){var e=t(this);e.append('<div class="ml15 btn-group"><button data-act="prev" class="btn btn-default date-range-selector"><i data-feather="chevron-left" class="icon-16"></i></button><button data-act="datepicker" class="btn btn-default"></button><button data-act="next"  class="btn btn-default date-range-selector"><i data-feather="chevron-right" class="icon-16"></i></button></div>');var i=e.find("[data-act='datepicker']"),n=e.find(".date-range-selector");if("yearly"===a.dateRangeType){var s=function(t){t.html(moment(a.filterParams.start_date).customFormat("YYYY"))};s(i),i.datepicker({format:"YYYY-MM",viewMode:"years",minViewMode:"years",autoclose:!0,language:"custom",orientation:"bottom"}).on("changeDate",function(t){var e=moment(t.date).customFormat(a._inputDateFormat),n=moment(e).customFormat("YYYY");a.filterParams.start_date=n+"-01-01",a.filterParams.end_date=n+"-12-31",a.filterParams.year=n,s(i),a.onChange(a.filterParams)});var r=moment().customFormat("YYYY");a.filterParams.start_date=r+"-01-01",a.filterParams.end_date=r+"-12-31",a.filterParams.year=r,a.onInit(a.filterParams),n.click(function(){var e=t(this).attr("data-act"),n=moment(a.filterParams.start_date),r=moment(a.filterParams.end_date);"next"===e?(n=n.add(1,"years").customFormat(a._inputDateFormat),r=r.add(1,"years").customFormat(a._inputDateFormat)):"prev"===e&&(n=n.subtract(1,"years").customFormat(a._inputDateFormat),r=r.subtract(1,"years").customFormat(a._inputDateFormat)),a.filterParams.start_date=n,a.filterParams.end_date=r,a.filterParams.year=moment(n).customFormat("YYYY"),s(i),a.onChange(a.filterParams)})}else if("monthly"===a.dateRangeType){var o=function(t){t.html(moment(a.filterParams.start_date).format("MMMM YYYY"))};o(i),i.datepicker({format:"YYYY-MM",viewMode:"months",minViewMode:"months",autoclose:!0,language:"custom"}).on("changeDate",function(t){var e=moment(t.date).customFormat(a._inputDateFormat),n=moment(e).daysInMonth(),s=moment(e).customFormat("YYYY-MM");a.filterParams.start_date=s+"-01",a.filterParams.end_date=s+"-"+n,o(i),a.onChange(a.filterParams)});var r=moment().customFormat("YYYY"),l=moment().customFormat("YYYY-MM"),d=moment().daysInMonth();a.filterParams.start_date=l+"-01",a.filterParams.end_date=l+"-"+d,a.filterParams.year=r,a.onInit(a.filterParams),n.click(function(){var e=t(this).attr("data-act"),n=moment(a.filterParams.start_date),s=moment(a.filterParams.end_date);if("next"===e){var r=n.add(1,"months"),l=r.daysInMonth(),d=r.customFormat("YYYY-MM");n=d+"-01",s=d+"-"+l}else if("prev"===e){var c=n.subtract(1,"months"),l=c.daysInMonth(),d=c.customFormat("YYYY-MM");n=d+"-01",s=d+"-"+l}a.filterParams.start_date=n,a.filterParams.end_date=s,a.filterParams.year=moment(n).customFormat("YYYY-MM"),o(i),a.onChange(a.filterParams)})}})}}(jQuery);var loadFilterView=function(t){t.source&&t.targetSelector&&appAjaxRequest({url:t.source,data:t.filterParams,cache:!1,type:"POST",success:function(e){$(t.targetSelector).html(e),appLoader.hide()},statusCode:{404:function(){appLoader.hide(),appAlert.error("404: Page not found.",{container:".modal-body",animate:!1})}},error:function(){appLoader.hide(),appAlert.error(AppLanugage.somethingWentWrong,{container:".modal-body",animate:!1})}})};!function(t){t.fn.appFilters=function(e){appLoader.show();var a={source:"",targetSelector:"",reloadSelector:"",dateRangeType:"",checkBoxes:[],multiSelect:[],radioButtons:[],filterDropdown:[],singleDatepicker:[],rangeDatepicker:[],stateSave:!0,ignoreSavedFilter:!1,isMobile:window.matchMedia("(max-width: 800px)").matches,filterParams:{customFilter:!0},search:{show:!1},customLanguage:{searchPlaceholder:AppLanugage.search,today:AppLanugage.today,yesterday:AppLanugage.yesterday,tomorrow:AppLanugage.tomorrow},beforeRelaodCallback:function(){},afterRelaodCallback:function(){},onInitComplete:function(){}},i=t(this),n=i,s=t.extend({},a,e);if(s.reload){var r=t(this),o=window.InstanceCollection[r.attr("id")];return r.data("beforeRelaodCallback")&&r.data("beforeRelaodCallback")(r,o.filterParams),loadFilterView(o),r.data("afterRelaodCallback")&&r.data("afterRelaodCallback")(r,o.filterParams),!1}var l="";s.smartFilterIdentity&&(l="<div class='filter-form'></div>"),n.append("<div class='filter-section-container'>\n                    <div class='filter-section-flex-row'>\n                            <div class='filter-section-left'></div><div class='filter-section-right'></div>\n                    </div>"+l+"</div>"),s._firstDayOfWeek=AppHelper.settings.firstDayOfWeek||0,s._inputDateFormat="YYYY-MM-DD",buildFilterDom(s=prepareDefaultFilters(s),n,i),window.InstanceCollection=window.InstanceCollection||{},window.InstanceCollection[i.attr("id")]=s,s.onInitComplete&&s.onInitComplete(i,s.filterParams),loadFilterView(s),i.data("beforeRelaodCallback",s.beforeRelaodCallback),i.data("afterRelaodCallback",s.afterRelaodCallback)}}(jQuery),replaceAllString=function(t,e,a){return t.split(e).join(a)},toCurrency=function(t,e){t="0"==AppHelper.settings.noOfDecimals?Math.round(parseFloat(t))+".00":parseFloat(t).toFixed(2),e||(e=AppHelper.settings.currencySymbol);var a=t.replace(/(\d)(?=(\d{3})+\.)/g,"$1,");return(" "===AppHelper.settings.thousandSeparator&&(a=a.replace(","," ")),","===AppHelper.settings.decimalSeparator&&(a=replaceAllString(a,".","_"),a=replaceAllString(a,",","."),a=replaceAllString(a,"_",",")),"none"===e&&(e=""),"0"==AppHelper.settings.noOfDecimals&&(a=a.slice(0,-3)),"right"===AppHelper.settings.currencyPosition)?a+""+e:"0"==a.indexOf("-")?"-"+e+(a=a.replace("-","")):e+""+a},calculateDatatableTotal=function(t,e,a,i){var n=t.api(),s={};return i&&(s={page:"current"}),n.column(e,s).data().reduce(function(t,e,i,n){return a?t+a(e):t+e},0)},unformatCurrency=function(t,e){var a=t=t.toString(),i=!1;if(t){if(t=t.replace(/[^0-9.,-]/g,""),e){var n=a.replace(t,"");e[n]&&(t=unformatDecimalSeparator(t),t=(t=1/e[n]*1*t).toString(),i=!0)}(0==t.indexOf(".")||0==t.indexOf(","))&&(t=t.slice(1)),i||(t=unformatDecimalSeparator(t)),t*=1}return t||0},unformatDecimalSeparator=function(t){return","===AppHelper.settings.decimalSeparator?(t=replaceAllString(t,".",""),t=replaceAllString(t,",",".")):t=replaceAllString(t,",",""),t},secondsToTimeFormat=function(t){var e=parseInt(t,10),a=Math.floor(e/3600),i=Math.floor((e-3600*a)/60),n=e-3600*a-60*i;return a<10&&(a="0"+a),i<10&&(i="0"+i),n<10&&(n="0"+n),a+":"+i+":"+n},clearAppTableState=function(t){t&&setTimeout(function(){t.api().state.clear()},200)},showHideAppTableColumn=function(t,e,a){t.fnSetColumnVis(e,!!a)},function(t){t.fn.appMention=function(e){var a=t.extend({},{at:"@",dataType:"json",source:"",data:{}},e),i=this;appAjaxRequest({url:a.source,data:a.data,dataType:a.dataType,method:"POST",success:function(e){e.success&&t(i).atwho({at:a.at,data:e.data,insertTpl:"${content}"})}})}}(jQuery),function(t){t.fn.appMultiSelect=function(e){var a=t.extend({},{text:"",options:[],onChange:function(t){},onInit:function(t){}},e);this.each(function(){var e=t(this),i="",n=[];t.each(a.options,function(t,e){var s="";e.isChecked&&(s=" active",n.push(e.id)),i+='<li class="list-group-item clickable '+s+'" data-name="'+a.name+'" data-value="'+e.id+'">',i+=e.text,i+="</li>"}),i="<div class='dropdown-menu'><ul class='list-group' data-act='multiselect'>"+i+"</ul></div>";var s='<div class=""><span class="dropdown inline-block filter-multi-select"><button class="btn btn-default dropdown-toggle caret " type="button" data-bs-toggle="dropdown" aria-expanded="true">'+a.text+" </button>"+i+"</span></div>";e.append(s),a.onInit(n),e.find("[data-name='"+a.name+"']").click(function(){var e=t(this);return e.toggleClass("active"),setTimeout(function(){var i=[];e.parent().find("li").each(function(){t(this).hasClass("active")&&i.push(t(this).attr("data-value"))}),a.onChange(i)}),!1})})}}(jQuery),function(t){t.fn.appModifier=function(e){var a=t(this),i=a.data()?a.data():{},n=t.extend({},{actionUrl:"",value:"",actionType:"dropdown",showButtons:!1,datepicker:{},select2Option:{},timepickerOptions:{},dataType:"json",postData:{},className:"",placeholder:"",ruleRequired:!1,msgRequired:"",dropdownData:{},onSuccess:function(){}},i,e);"select2"==n.actionType&&(n.actionType="dropdown"),"dropdown"===n.actionType&&n.field&&n.dropdownData[n.field]&&(n.select2Option.data=n.dropdownData[n.field]),a.attr("data-value")&&(n.value=a.attr("data-value")),"1"==n.canCreateTags&&(n.showButtons=!0,n.select2Option.tags=n.select2Option.data?n.select2Option.data:[],delete n.select2Option.data),"1"==n.multipleTags&&(n.showButtons=!0,n.select2Option.multiple=!0);var s=getRandomAlphabet(5),r="";n.showButtons&&(r="<div class='custom-popover-button-area mt10 clearfix row'>\n                            <div id='custom-popover-submit-btn-"+s+"' class='col-md-6 pr5'><button class='btn btn-primary btn-sm w100p'><i data-feather='check' class='icon-16'></i></button></div>\n                            <div class='col-md-6 pl5 custom-popover-close-btn'><button class='btn btn-default btn-sm w100p'><i data-feather='x' class='icon-16'></i></button></div>\n                        </div>");var o="";n.ruleRequired&&(o=" data-rule-required=1 ",n.msgRequired&&(o+=' data-msg-required= "'+n.msgRequired+'" '));var l="";if("dropdown"===n.actionType)l='<input id="'+s+'" value="'+n.value+'" placeholder="'+n.placeholder+'" type="text" class="form-control popover-tempId '+n.className+'" '+o+"/> "+r;else if("date"===n.actionType){var d=getJsDateFormat(),c=n.value.split("-"),p=c[0],u=c[1],m=c[2];l='<div style="height: 240px;" id="'+s+'"  data-date="'+d.replace("yyyy",p).replace("mm",u).replace("dd",m)+'" data-date-format="'+d+'" class="popover-tempId" '+o+"></div>"}else"time"===n.actionType?l='<input class="form-control" type="text" id="'+s+'"  value="'+n.value+'" /><div id="popover-timepicker-container-'+s+'" '+o+"></div>"+r:"text"===n.actionType&&(l='<input class="form-control" type="text" id="'+s+'"  value="'+n.value+'" '+o+' /><div class="js-help-message"></div> '+r);var f=a.offset(),h=f.top,v=f.left,g="<div class='app-popover' style='max-width: 350px; top: "+(h+a.outerHeight()+10)+"px; left: "+v+"px'>\n                                <span class='app-popover-arrow' ></span>\n                                <div class='app-popover-body'>\n                                    <div class='loader-container inline-loader hide'></div>\n                                    "+l+" \n                                </div>\n                            </div>";t(".app-popover").remove(),t("body").append(g),feather.replace();var b=t("#"+s),y=t("#popover-timepicker-container-"+s);if("dropdown"===n.actionType){if(n.showButtons)t("#"+s).select2(n.select2Option);else if(n.select2Option.data.length>0&&n.select2Option.data.length<=7){window["initAjaxAction_"+s]=function(e,i){w(a,e,n,i),t("#"+s).next()&&t("#"+s).next().addClass("hide")};var k="";n.select2Option.data.forEach(t=>{var e="";n.value==t.id&&(e="active"),k+=`<a href="#" class="dropdown-item list-group-item ${e}" onclick='initAjaxAction_${s}("${t.id}", "${t.text}")'>${t.text}</a>`}),t("#"+s).closest(".app-popover-body").addClass("pl0 pr0").append("<div>"+k+"</div>"),t("#"+s).addClass("hide")}else t("#"+s).select2(n.select2Option).change(function(e){w(a,t(this).val(),n,e.added.text)})}else if("date"===n.actionType)n.datepicker.onChangeDate=function(t){w(a,t,n)},setDatePicker("#"+s,n.datepicker);else if("time"===n.actionType){var D="24_hours"!=AppHelper.settings.timeFormat,x=t.extend({},{minuteStep:AppHelper.settings.timepickerMinutesInterval,defaultTime:"",appendWidgetTo:"#popover-timepicker-container-"+s,showMeridian:D,isInline:!0},n.timepickerOptions);b.timepicker(x),b.timepicker().on("show.timepicker",function(t){feather.replace()}),setTimeout(function(){b.focus(),setTimeout(function(){t(".bootstrap-timepicker-widget").removeClass("dropdown-menu")})})}else"text"===n.actionType&&(b.on("keydown",function(e){13===e.keyCode&&(e.preventDefault(),t("div#custom-popover-submit-btn-"+s).trigger("click"))}),setTimeout(function(){b.focus().select()}));function w(e,a,i,n){var s=b.closest(".app-popover-body").height(),r=b.closest(".app-popover-body").width();b.closest(".app-popover-body").find(".loader-container").removeClass("hide").css({height:s,width:r}),b.closest(".app-popover-body").find(".custom-popover-button-area").addClass("hide"),b.addClass("hide"),y.addClass("hide");var o=t.extend({},i.postData,{value:a});appAjaxRequest({url:i.actionUrl,type:"POST",dataType:i.dataType,data:o,success:function(s){if(t(".app-popover").remove(),setTimeout(function(){b.closest(".app-popover-body").find(".loader-container").addClass("hide"),b.closest(".app-popover-body").find(".custom-popover-button-area").removeClass("hide"),b.removeClass("hide"),y.removeClass("hide")},200),s.success){i.onSuccess(s,a),s.content?e.html(s.content):n&&e.text(n),e.attr("data-value",a),t(".app-popover").remove();var r=e.attr("data-modifier-group");r&&window.appModifierHooks&&window.appModifierHooks[r]&&window.appModifierHooks[r].forEach(function(t){"function"==typeof t.onSuccess&&t.onSuccess(e.data(),s)})}else appAlert.error(s.message)}})}t("body").find(".app-popover").each(function(){var e=t(window).width()-(t(this).offset().left+t(this).outerWidth());if(e<0){t(this).css({left:"unset",right:"10px"});var e=t(window).width()-(a.offset().left+a.outerWidth()/2*1);t(this).find(".app-popover-arrow").css({left:"unset",right:e})}}),t("div#custom-popover-submit-btn-"+s).click(function(){if(n.ruleRequired&&!b.val())return b.parent().addClass("has-error").find(".js-help-message").html('<span class="help-block" style="">'+n.msgRequired+"</span>"),!1;b.val()&&b.parent().removeClass("has-error").find(".js-help-message").html(""),w(a,b.val(),n)}),t(".custom-popover-close-btn").click(function(){t(".app-popover").remove()})}}(jQuery),function(t){t.fn.appConfirmation=function(e){var a=t.extend({},{title:"",btnConfirmLabel:"",btnCancelLabel:"",onConfirm:function(){}},e),i=t(this).offset(),n=i.top,s=i.left,r="<div class='app-popover' style='bottom: "+(t(window).height()-(n-10))+"px; left: "+s+"px'>\n                                <span class='app-popover-arrow bottom-arrow' ></span>\n                                <div class='loader-container inline-loader hide'></div>\n                                <div class='app-popover-content-container'>\n                                    <div class='confirmation-title'>"+a.title+"</div>\n                                    <div class='app-popover-body pt0'>\n                                        <div class='custom-popover-button-area mt15 clearfix row'>\n                                            <div class='col-md-6 pr5'><button class='btn btn-danger w100p confirmation-confirm-button'><i data-feather='check' class='icon-16'></i> "+a.btnConfirmLabel+"</button></div>\n                                            <div class='col-md-6 pl5'><button class='btn btn-default w100p confirmation-cancel-button'><i data-feather='x' class='icon-16'></i> "+a.btnCancelLabel+"</button></div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>";t(".app-popover").remove(),t("body").append(r),feather.replace(),t(".confirmation-confirm-button").click(function(){t(".app-popover").remove(),a.onConfirm()}),t(".confirmation-cancel-button").click(function(){t(".app-popover").remove()})}}(jQuery),function(t){t.fn.appSortable=function(e){var a=t(this),i=a,n=t.extend({},{actionUrl:"",rowClass:"",sortDirection:"asc"},e);if(a.attr("id").endsWith("table")){var s=getRandomAlphabet(5);a.find("tbody").attr("id",s),i=t("#"+s)}Sortable.create(i[0],{animation:150,handle:".move-icon",chosenClass:"sortable-chosen",ghostClass:"sortable-ghost",onUpdate:function(e){if(appLoader.show(),a.attr("id").endsWith("table"))var i=t(e.item).find(n.rowClass),s=i.closest("tr").prev("tr").find(n.rowClass),r=i.closest("tr").next("tr").find(n.rowClass);else var i=t(e.item),s=i.prev(n.rowClass),r=i.next(n.rowClass);var o=s.attr("data-sort-value")||null,l=r.attr("data-sort-value")||null;l=l?1*l:null;let d;d=Math.round(1e5*(d=null!==(o=o?1*o:null)&&null!==l?(o+l)/2:null==o?"asc"===n.sortDirection?l-.1:l+1:null==l?"asc"===n.sortDirection?o+1:o-.1:1))/1e5,i.attr("data-sort-value",d),t.ajax({url:n.actionUrl,type:"POST",data:{id:i.attr("data-id"),sort:d},success:function(){appLoader.hide()}})}})}}(jQuery);